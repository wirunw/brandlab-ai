<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharm Connex Brand Lab v3</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=inter:wght@400;500;600;700&family=sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #7c3aed;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-bg: #1f2937;
            --dark-surface: #374151;
            --dark-text: #f3f4f6;
            --text-strong: #0f172a;
            --text-default: #1f2937;
            --text-muted: #475569;
            --card-bg-light: #fdfdff;
            --card-border-light: rgba(15, 23, 42, 0.08);
            --card-bg-dark: rgba(17, 24, 39, 0.96);
            --card-border-dark: rgba(148, 163, 184, 0.3);
        }

        body {
            font-family: 'Inter', 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            transition: all 0.3s ease;
            color: var(--text-default);
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            --text-strong: #f8fafc;
            --text-default: #f1f5f9;
            --text-muted: #cbd5f5;
            color: var(--text-default);
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        body.dark-mode .glass-morphism {
            background: rgba(31, 41, 55, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Typography */
        body:not(.dark-mode) h1,
        body:not(.dark-mode) h2,
        body:not(.dark-mode) h3,
        body:not(.dark-mode) h4,
        body:not(.dark-mode) h5,
        body:not(.dark-mode) h6 {
            color: var(--text-strong);
        }

        body:not(.dark-mode) p,
        body:not(.dark-mode) label,
        body:not(.dark-mode) span,
        body:not(.dark-mode) li,
        body:not(.dark-mode) input,
        body:not(.dark-mode) textarea {
            color: var(--text-default);
        }

        body:not(.dark-mode) .text-gray-400,
        body:not(.dark-mode) .text-gray-500,
        body:not(.dark-mode) .text-gray-600,
        body:not(.dark-mode) .text-gray-700 {
            color: var(--text-muted) !important;
        }

        body.dark-mode h1,
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4,
        body.dark-mode h5,
        body.dark-mode h6,
        body.dark-mode p,
        body.dark-mode label,
        body.dark-mode span,
        body.dark-mode li,
        body.dark-mode input,
        body.dark-mode textarea {
            color: var(--text-default);
        }

        body.dark-mode .text-gray-400,
        body.dark-mode .text-gray-500,
        body.dark-mode .text-gray-600,
        body.dark-mode .text-gray-700 {
            color: var(--text-default) !important;
        }

        /* Surface balancing */
        .step-panel,
        #group-select-container,
        #workspace-utilities,
        .vpc-card,
        .sticky-block,
        .bmc-block-final,
        #visualization-panel,
        .modal-card {
            background-color: var(--card-bg-light);
            border: 1px solid var(--card-border-light);
            color: var(--text-default);
        }

        body.dark-mode .step-panel,
        body.dark-mode #group-select-container,
        body.dark-mode #workspace-utilities,
        body.dark-mode .vpc-card,
        body.dark-mode .sticky-block,
        body.dark-mode .bmc-block-final,
        body.dark-mode #visualization-panel,
        body.dark-mode .modal-card {
            background-color: var(--card-bg-dark);
            border: 1px solid var(--card-border-dark);
            color: var(--text-default);
        }

        #history-list {
            background-color: rgba(248, 250, 252, 0.95);
            border: 1px dashed var(--card-border-light);
            color: var(--text-muted);
        }

        body.dark-mode #history-list {
            background-color: rgba(15, 23, 42, 0.7);
            border-color: var(--card-border-dark);
            color: var(--text-default);
        }

        input[type="text"],
        select,
        textarea {
            background-color: rgba(255, 255, 255, 0.96);
            border: 1px solid rgba(15, 23, 42, 0.12);
            color: var(--text-default);
        }

        body.dark-mode input[type="text"],
        body.dark-mode select,
        body.dark-mode textarea {
            background-color: rgba(17, 24, 39, 0.85);
            border: 1px solid rgba(148, 163, 184, 0.4);
            color: var(--text-default);
        }

        input::placeholder,
        textarea::placeholder {
            color: var(--text-muted);
            opacity: 0.8;
        }

        body.dark-mode input::placeholder,
        body.dark-mode textarea::placeholder {
            color: rgba(241, 245, 249, 0.7);
        }

        .bmc-textarea,
        .bmc-textarea-sm {
            background-color: rgba(255, 255, 255, 0.98);
        }

        body.dark-mode .bmc-textarea,
        body.dark-mode .bmc-textarea-sm {
            background-color: rgba(17, 24, 39, 0.95);
        }

        .empty-state {
            color: var(--text-muted);
        }

        body.dark-mode .empty-state {
            color: rgba(241, 245, 249, 0.8);
        }

        /* Progress Bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            color: var(--text-default);
        }

        body.dark-mode .progress-container {
            background: rgba(31, 41, 55, 0.9);
        }

        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width 0.3s ease;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .progress-step {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-muted);
            transition: color 0.3s ease;
        }

        .progress-step.active {
            color: var(--primary-color);
            font-weight: 600;
        }

        .progress-step.completed {
            color: var(--success-color);
        }

        .progress-step-number {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .progress-step.active .progress-step-number {
            background: var(--primary-color);
            color: white;
        }

        .progress-step.completed .progress-step-number {
            background: var(--success-color);
            color: white;
        }

        body.has-progress {
            padding-top: 150px;
        }

        @media (max-width: 768px) {
            body.has-progress {
                padding-top: 190px;
            }
        }

        /* Auto-save Indicator */
        .save-indicator {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 0.5rem 1rem;
            background: var(--success-color);
            color: white;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        body.has-progress .save-indicator {
            top: 170px;
        }

        /* Character Counter */
        .char-counter {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: right;
            margin-top: 0.25rem;
        }

        .char-counter.warning {
            color: var(--warning-color);
        }

        .char-counter.danger {
            color: var(--danger-color);
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 0.5rem;
            padding: 0.5rem;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .dark-mode-toggle {
            background: rgba(31, 41, 55, 0.9);
        }

        /* Micro-interactions */
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        /* Smooth Transitions */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state-hint {
            font-size: 0.95rem;
            line-height: 1.4;
        }

        /* Enhanced Buttons */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .progress-steps {
                padding: 0.5rem 1rem;
            }
            
            .progress-step span {
                display: none;
            }
        }
        
        .bmc-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            outline: none;
            height: 12rem;
            resize: vertical;
        }
        .bmc-textarea:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .bmc-textarea-sm {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            outline: none;
            height: 10rem;
            resize: vertical;
        }
        .bmc-textarea-sm:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* --- VPC Grid --- */
        .vpc-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1.5rem;
        }
        @media (min-width: 1024px) {
            .vpc-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .vpc-card {
            background-color: #ffffff;
            padding: 1.25rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .vpc-card h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            border-bottom-width: 2px;
            border-bottom-style: solid;
            padding-bottom: 0.5rem;
        }
        .vpc-customer h3 { 
            color: #b91c1c; 
            border-color: #fecaca; 
        }
        .vpc-value h3 { 
            color: #1d4ed8; 
            border-color: #dbeafe; 
        }
        
        /* --- Sticky Info Accordion --- */
        details {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }
        summary {
            padding: 1rem;
            font-weight: 600;
            color: #374151;
            cursor: pointer;
            list-style: none;
        }
        summary:hover {
            background-color: #f3f4f6;
        }
        .sticky-content {
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
            font-size: 0.875rem;
            color: #4b5563;
        }
        .sticky-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1rem;
        }
        @media (min-width: 768px) {
            .sticky-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .sticky-block {
            background-color: #ffffff;
            padding: 0.75rem;
            border-radius: 0.25rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .sticky-block h5 { 
            font-weight: 700; 
            color: #1f2937; 
            margin-bottom: 0.25rem; 
        }

        /* --- Final BMC Grid (for Display & Print) --- */
        .bmc-grid-final {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: auto auto auto;
            gap: 1rem;
            min-height: 80vh;
            background: #fff;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        @media (max-width: 1024px) {
            .bmc-grid-final {
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: auto;
            }

            .bmc-grid-final > div {
                grid-column: auto !important;
                grid-row: auto !important;
            }
        }

        @media (max-width: 640px) {
            .bmc-grid-final {
                grid-template-columns: 1fr;
            }
        }
        .bmc-block-final {
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        .bmc-block-final h3 {
            font-size: 0.875rem;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        .bmc-icon {
            height: 1.25rem;
            width: 1.25rem;
            margin-right: 0.5rem;
            color: #2563eb;
        }
        .bmc-block-final-content {
            font-size: 0.875rem;
            color: #374151;
            flex-grow: 1;
            white-space: pre-wrap; /* Respect newlines */
        }
        /* Grid placements */
        .bmc-kp { grid-column: 1 / 2; grid-row: 2 / 3; }
        .bmc-ka { grid-column: 2 / 3; grid-row: 2 / 3; }
        .bmc-vp { grid-column: 3 / 4; grid-row: 2 / 3; background-color: #eff6ff; border-color: #dbeafe; }
        .bmc-cr { grid-column: 4 / 5; grid-row: 2 / 3; }
        .bmc-cs { grid-column: 5 / 6; grid-row: 2 / 3; background-color: #fef2f2; border-color: #fecaca; }
        .bmc-kr { grid-column: 2 / 3; grid-row: 1 / 2; }
        .bmc-ch { grid-column: 4 / 5; grid-row: 1 / 2; }
        .bmc-c { grid-column: 1 / 4; grid-row: 3 / 4; background-color: #fef2f2; }
        .bmc-r { grid-column: 4 / 7; grid-row: 3 / 4; background-color: #f0fdf4; }

        /* --- Print Styles --- */
        @media print {
            body {
                font-family: 'Sarabun', sans-serif; /* Use Sarabun for print */
                background: #fff;
            }
            .no-print {
                display: none !important;
            }
            .print-container {
                display: block !important;
                width: 100%;
                margin: 0;
                padding: 0;
            }
            .bmc-grid-final {
                min-height: auto;
                box-shadow: none;
                border: 1px solid #ddd;
                padding: 1rem;
                gap: 0.5rem;
            }
            .bmc-block-final {
                box-shadow: none;
                border: 1px solid #eee;
                padding: 0.5rem;
            }
            .bmc-block-final h3 {
                font-size: 10pt;
                margin-bottom: 4px;
                padding-bottom: 2px;
            }
            .bmc-icon {
                height: 1rem;
                width: 1rem;
                margin-right: 0.25rem;
            }
            .bmc-block-final-content {
                font-size: 9pt;
            }
            #print-title {
                display: block !important;
                text-align: center;
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1rem;
            }
            @page {
                size: A4 landscape;
                margin: 1cm;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    
    <!-- Progress Bar -->
    <div id="progress-container" class="progress-container hidden">
        <div class="progress-bar" id="progress-bar"></div>
        <div class="progress-steps">
            <div class="progress-step" data-step="1">
                <div class="progress-step-number">1</div>
                <span>The Lab</span>
            </div>
            <div class="progress-step" data-step="2">
                <div class="progress-step-number">2</div>
                <span>The VPC</span>
            </div>
            <div class="progress-step" data-step="3">
                <div class="progress-step-number">3</div>
                <span>Synthesize</span>
            </div>
            <div class="progress-step" data-step="4">
                <div class="progress-step-number">4</div>
                <span>Go-to-Market</span>
            </div>
            <div class="progress-step" data-step="5">
                <div class="progress-step-number">5</div>
                <span>The Engine</span>
            </div>
            <div class="progress-step" data-step="6">
                <div class="progress-step-number">6</div>
                <span>The Finance</span>
            </div>
            <div class="progress-step" data-step="7">
                <div class="progress-step-number">7</div>
                <span>Full BMC</span>
            </div>
        </div>
    </div>

    <!-- Auto-save Indicator -->
    <div id="save-indicator" class="save-indicator">
        ‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß
    </div>

    <!-- Dark Mode Toggle -->
    <div id="dark-mode-toggle" class="dark-mode-toggle">
        <svg id="sun-icon" class="w-6 h-6 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
        </svg>
        <svg id="moon-icon" class="w-6 h-6 text-gray-700 hidden" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
        </svg>
    </div>
    
    <!-- Phase 1: Group Selection -->
    <div id="group-select-container" class="max-w-md mx-auto bg-white p-8 rounded-lg shadow-xl text-center hover-lift">
        <!-- Logo -->
        <img src="https://i.postimg.cc/yY1rPJ07/wirun_facbook.png" alt="Logo Wirun Wetsiri" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-blue-500 p-1">
        
        <h1 class="text-3xl font-bold text-blue-800 mb-2">Pharm Connex Brand Lab</h1>
        <p class="text-gray-600 mb-6">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå "From Lab to Launch"</p>
        
        <div class="mb-6 text-left">
            <label for="group-name-input" class="block text-lg font-medium text-gray-700 mb-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</label>
            <input type="text" id="group-name-input" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg" placeholder="‡πÄ‡∏ä‡πà‡∏ô '‡∏Å‡∏•‡∏∏‡πà‡∏° 1 - ‡πÉ‡∏ö‡πÄ‡∏™‡∏°‡πá‡∏î‡πÅ‡∏î‡∏á'">
        </div>
        
        <button id="start-workshop-btn" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold text-lg hover:bg-blue-700 transition duration-300 shadow-lg">
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Workshop
        </button>

        <div class="mt-6 text-left">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ:</h3>
            <div id="landing-group-list" class="space-y-2 text-left">
                <p class="text-sm text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
            </div>
        </div>
        
        <p class="text-xs text-gray-400 mt-8">
            Designed by ‡∏†‡∏Å.‡∏ß‡∏¥‡∏£‡∏∏‡∏ì ‡πÄ‡∏ß‡∏ä‡∏®‡∏¥‡∏£‡∏¥
        </p>
    </div>

    <!-- Phase 2: Workshop Application -->
    <div id="app-container" class="hidden max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6 no-print">
            <div>
                <h1 class="text-3xl font-bold text-blue-800">Pharm Connex Brand Lab</h1>
                <p id="group-info" class="text-xl text-gray-700"></p>
            </div>
            <div class="flex space-x-2">
                <button id="export-data-btn" class="bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition duration-300">
                    ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
                <label class="bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition duration-300 cursor-pointer">
                    ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    <input type="file" id="import-data-btn" accept=".json" class="hidden">
                </label>
                <button id="template-btn" class="bg-purple-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-purple-700 transition duration-300">
                    ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï
                </button>
                <button id="reset-data-btn" class="bg-red-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-600 transition duration-300">
                    ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Reset)
                </button>
            </div>
        </div>

        <!-- Workspace Utilities -->
        <div id="workspace-utilities" class="bg-white p-4 rounded-lg shadow-md mb-6 space-y-4 no-print hover-lift">
            <div class="grid gap-4 lg:grid-cols-2">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 flex items-center space-x-2 mb-3">
                        <span>üóÇÔ∏è</span><span>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°</span>
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        <select id="group-switcher" class="flex-1 border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</option>
                        </select>
                        <button id="load-group-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">‡πÇ‡∏´‡∏•‡∏î</button>
                        <button id="compare-groups-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</button>
                    </div>
                    <div class="flex flex-wrap gap-2 mt-3">
                        <button id="undo-btn" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">Undo</button>
                        <button id="redo-btn" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">Redo</button>
                    </div>
                    <div id="history-list" class="mt-3 max-h-40 overflow-y-auto bg-gray-50 rounded-lg p-3 text-sm text-gray-600 space-y-2 border border-dashed border-gray-200">
                        <p class="text-gray-400 text-xs">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 flex items-center space-x-2 mb-3">
                        <span>üíæ</span><span>Backup / Share & Visualization</span>
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        <button id="backup-all-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Backup ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <label for="restore-backup-input" class="bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 cursor-pointer">Restore</label>
                        <input type="file" id="restore-backup-input" class="hidden" accept=".json">
                        <button id="screenshot-btn" class="bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600">Screenshot</button>
                        <button id="share-btn" class="bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700">Share</button>
                    </div>
                    <div class="flex flex-wrap gap-2 mt-3">
                        <button id="visualize-btn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">Refresh Chart</button>
                        <span class="text-xs text-gray-500 flex items-center">* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web Share API</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Copilot -->
        <section id="ai-lab" class="no-print mb-6">
            <div class="glass-morphism rounded-2xl shadow-2xl p-6 space-y-6 border border-white/30 dark:border-slate-700/80">
                <div class="grid gap-6 lg:grid-cols-2">
                    <div class="space-y-4">
                        <div class="flex items-center gap-3">
                            <div class="text-3xl">ü§ñ</div>
                            <div>
                                <p class="text-xs font-semibold uppercase tracking-[0.25em] text-indigo-500">AI Co-creator</p>
                                <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Typhoon Strategy Desk</h2>
                            </div>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
                            ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ Typhoon ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ insight, headline, ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡∏´‡∏£‡∏∑‡∏≠ action plan ‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å Business Model Canvas ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏ß‡πâ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á API Key ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ú‡πà‡∏≤‡∏ô Netlify Function ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                        </p>
                        <ul class="text-sm text-gray-500 dark:text-gray-300 list-disc list-inside space-y-1">
                            <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</li>
                            <li>‡πÅ‡∏ô‡∏ö context ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å BMC ‡∏ó‡∏µ‡πà Save ‡πÑ‡∏ß‡πâ</li>
                            <li>‡∏Å‡∏î‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡πÉ‡∏ô Step ‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
                        </ul>
                    </div>
                    <div>
                        <form id="ai-form" class="space-y-4">
                            <div>
                                <label for="ai-prompt" class="font-semibold text-gray-700 dark:text-gray-200">‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ Typhoon ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏∞‡πÑ‡∏£?</label>
                                <textarea id="ai-prompt" required class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 p-3 text-gray-700 focus:ring-2 focus:ring-indigo-500" rows="3" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏£‡∏∏‡∏õ Value Proposition ‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏¥‡∏î teaser campaign ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà"></textarea>
                            </div>
                            <div class="grid gap-4 md:grid-cols-2">
                                <div>
                                    <label for="ai-tone" class="font-semibold text-gray-700 dark:text-gray-200">‡πÇ‡∏ó‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á</label>
                                    <select id="ai-tone" class="mt-2 w-full rounded-xl border border-gray-200 bg-white/80 p-3 text-gray-700 focus:ring-2 focus:ring-indigo-500">
                                        <option value="inspiring">Inspiring Visionary</option>
                                        <option value="practical">Practical & Actionable</option>
                                        <option value="playful">Playful & Friendly</option>
                                        <option value="formal">Formal & Executive</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="ai-deliverable" class="font-semibold text-gray-700 dark:text-gray-200">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ</label>
                                    <select id="ai-deliverable" class="mt-2 w-full rounded-xl border border-gray-200 bg-white/80 p-3 text-gray-700 focus:ring-2 focus:ring-indigo-500">
                                        <option value="brand-story">Brand Story / Narrative</option>
                                        <option value="campaign-ideas">Campaign Concepts</option>
                                        <option value="customer-insight">Customer Insight Summary</option>
                                       <option value="value-prop">Value Proposition Rewrite</option>
                                        <option value="gtm-brief">Go-to-Market Checklist</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label for="ai-context" class="font-semibold text-gray-700 dark:text-gray-200">‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                                <textarea id="ai-context" class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 p-3 text-gray-700 focus:ring-2 focus:ring-indigo-500" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏ insight ‡∏û‡∏¥‡πÄ‡∏®‡∏©, constraint, budget ‡∏´‡∏£‡∏∑‡∏≠ KPI"></textarea>
                            </div>
                            <div class="flex flex-wrap items-center justify-between gap-2 text-sm text-gray-500">
                                <label class="inline-flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="ai-use-bmc" class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                    <span>‡πÅ‡∏ô‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å BMC ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏ß‡πâ</span>
                                </label>
                                <span id="ai-status" class="hidden text-indigo-600 font-semibold animate-pulse">Typhoon ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢...</span>
                            </div>
                            <button type="submit" class="w-full rounded-2xl bg-gradient-to-r from-indigo-500 via-purple-500 to-blue-500 py-3 font-semibold text-white shadow-lg transition hover:shadow-2xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                Generate with Typhoon
                            </button>
                        </form>
                    </div>
                </div>
                <div class="grid gap-4 lg:grid-cols-3">
                    <div class="lg:col-span-2">
                        <div class="rounded-2xl bg-slate-900/95 p-5 text-slate-100 h-full">
                            <div class="flex items-center justify-between mb-4">
                                <p class="font-semibold uppercase tracking-wide text-xs text-indigo-200">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                                <div class="flex gap-3 text-xs">
                                    <button id="ai-copy-btn" type="button" class="text-indigo-200 hover:text-white transition disabled:opacity-40">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                                    <button id="ai-reset-output" type="button" class="text-indigo-200 hover:text-white transition">‡∏•‡πâ‡∏≤‡∏á</button>
                                </div>
                            </div>
                            <div id="ai-output" class="min-h-[180px] whitespace-pre-wrap text-sm leading-relaxed text-slate-50">
                                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å Typhoon
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="glass-morphism h-full rounded-2xl border border-dashed border-indigo-200/60 p-4">
                            <div class="flex items-center justify-between mb-3">
                                <p class="font-semibold text-gray-700 dark:text-gray-100">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</p>
                                <button id="ai-clear-history" type="button" class="text-xs text-red-500 hover:text-red-600">‡∏•‡πâ‡∏≤‡∏á</button>
                            </div>
                            <div id="ai-history" class="space-y-2 text-sm max-h-64 overflow-y-auto text-gray-600 dark:text-gray-200">
                                <p class="text-xs text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô AI</p>
                            </div>
                        </div>
                    </div>
                </div>
                <p id="ai-error" class="text-sm text-red-500 hidden"></p>
            </div>
        </section>

        <!-- Navigation Tabs (for quick jumps) -->
        <div class="mb-6 no-print">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-4 overflow-x-auto" aria-label="Tabs">
                    <button class="nav-tab" data-step="1">1. The Lab</button>
                    <button class="nav-tab" data-step="2">2. The VPC</button>
                    <button class="nav-tab" data-step="3">3. Synthesize</button>
                    <button class="nav-tab" data-step="4">4. Go-to-Market</button>
                    <button class="nav-tab" data-step="5">5. The Engine</button>
                    <button class="nav-tab" data-step="6">6. The Finance</button>
                    <button class="nav-tab" data-step="7">7. Full BMC</button>
                </nav>
            </div>
        </div>

        <!-- Step Content -->
        <div id="step-content">
            <!-- Step 1: The Lab -->
            <div id="step-1-content" class="step-panel bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: The Lab (‡∏ï‡πâ‡∏ô‡∏ô‡πâ‡∏≥)</h2>
                <p class="text-gray-600 mb-4">‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå" (Scientific Evidence) ‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏∏‡∏ì... ‡∏°‡∏µ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á? (‡πÄ‡∏ä‡πà‡∏ô ‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏¢‡∏≤, ‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç, ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö) ‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Value Proposition</p>
                <textarea id="bmc-lab" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å‡∏°‡∏µ‡∏™‡∏≤‡∏£ Triterpenoids ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏°‡∏≤‡∏ô‡πÅ‡∏ú‡∏•, ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö, ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏•‡∏≤‡πÄ‡∏à‡∏ô..."></textarea>
            </div>

            <!-- Step 2: Value Proposition Canvas (VPC) -->
            <div id="step-2-content" class="step-panel hidden bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: Value Proposition Canvas (VPC)</h2>
                <p class="text-gray-600 mb-6">‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤" ‡πÅ‡∏•‡∏∞ "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤" ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏™‡∏ô‡∏≠ [Image of Value Proposition Canvas]</p>
                <div class="vpc-grid">
                    <!-- Customer Profile -->
                    <div class="vpc-card vpc-customer hover-lift">
                        <h3>Customer Profile (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="font-semibold" for="bmc-vpc-jobs">Customer Jobs:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô?</p>
                                <textarea id="bmc-vpc-jobs" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏´‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏™‡∏¥‡∏ß, ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏¢‡∏î‡∏≥‡∏à‡∏≤‡∏á‡∏•‡∏á, ‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏Ç‡∏∂‡πâ‡∏ô"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold" for="bmc-vpc-pains">Pains:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏à‡πá‡∏ö‡∏õ‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£?</p>
                                <textarea id="bmc-vpc-pains" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏à‡πá‡∏ö, ‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á, ‡∏£‡∏≠‡∏¢‡∏™‡∏¥‡∏ß‡∏´‡∏≤‡∏¢‡∏ä‡πâ‡∏≤, ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold" for="bmc-vpc-gains">Gains:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á/‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏≠‡∏∞‡πÑ‡∏£ (‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ Pain)?</p>
                                <textarea id="bmc-vpc-gains" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏´‡∏≤‡∏¢‡πÑ‡∏ß, ‡∏ú‡∏¥‡∏ß‡πÑ‡∏°‡πà‡∏•‡∏≠‡∏Å, ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô, ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤, ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)"></textarea>
                            </div>
                        </div>
                    </div>
                    <!-- Value Map -->
                    <div class="vpc-card vpc-value hover-lift">
                        <h3>Value Map (‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤)</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="font-semibold" for="bmc-vpc-products">Products & Services:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£? (‡∏à‡∏≤‡∏Å Step 1)</p>
                                <textarea id="bmc-vpc-products" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡πÄ‡∏à‡∏•‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å, ‡πÄ‡∏ã‡∏£‡∏±‡πà‡∏°‡∏•‡∏î‡∏£‡∏≠‡∏¢"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold" for="bmc-vpc-relievers">Pain Relievers:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤ "‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤ Pain" ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                                <textarea id="bmc-vpc-relievers" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏•‡∏î‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÑ‡∏ß, ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô, ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold" for="bmc-vpc-creators">Gain Creators:</label>
                                <p class="text-sm text-gray-500 mb-1">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤ "‡∏™‡∏£‡πâ‡∏≤‡∏á Gain" ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                                <textarea id="bmc-vpc-creators" class="bmc-textarea-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏•‡∏î‡∏£‡∏≠‡∏¢‡∏î‡∏≥‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤), ‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Synthesize VP & CS -->
            <div id="step-3-content" class="step-panel hidden bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Value Proposition & Customer</h2>
                <p class="text-gray-600 mb-4">‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å VPC ‡∏°‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô "‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤" (VP) ‡πÅ‡∏•‡∏∞ "‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢" (CS) ‡πÉ‡∏´‡πâ‡∏Ñ‡∏°‡∏ä‡∏±‡∏î</p>
                
                <details class="sticky-info no-print">
                    <summary>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å VPC (‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2)</summary>
                    <div class="sticky-content sticky-grid">
                        <div class="sticky-block"><h5>Pains:</h5><pre id="sticky-vpc-pains">...</pre></div>
                        <div class="sticky-block"><h5>Gains:</h5><pre id="sticky-vpc-gains">...</pre></div>
                        <div class="sticky-block"><h5>Pain Relievers:</h5><pre id="sticky-vpc-relievers">...</pre></div>
                        <div class="sticky-block"><h5>Gain Creators:</h5><pre id="sticky-vpc-creators">...</pre></div>
                    </div>
                </details>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-bold text-blue-800 mb-2">Value Proposition (VP)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö (‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤): ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏∞‡πÑ‡∏£ ‡πÉ‡∏Ñ‡∏£ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                        <textarea id="bmc-vp" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡πÄ‡∏à‡∏•‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÉ‡∏ô 6 ‡∏ä‡∏°. ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏î‡∏£‡∏≠‡∏¢‡∏î‡∏≥ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á‡∏•‡∏≠‡∏Å"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-red-800 mb-2">Customer Segments (CS)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å: ‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£? (‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≤‡∏Å Customer Profile)</p>
                        <textarea id="bmc-cs" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô-‡∏ß‡∏±‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (18-30 ‡∏õ‡∏µ) ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö, ‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢, ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≠‡∏¢‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô, ‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏á‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 4: Go-to-Market -->
            <div id="step-4-content" class="step-panel hidden bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: Go-to-Market (‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</h2>
                
                <details class="sticky-info no-print">
                    <summary>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π VP & CS (‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3)</summary>
                    <div class="sticky-content sticky-grid">
                        <div class="sticky-block"><h5>Value Proposition:</h5><pre id="sticky-vp-1">...</pre></div>
                        <div class="sticky-block"><h5>Customer Segments:</h5><pre id="sticky-cs-1">...</pre></div>
                    </div>
                </details>
                
                <p class="text-gray-600 mb-4">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ "‡∏™‡∏±‡∏ç‡∏ç‡∏≤" (VP) ‡πÅ‡∏•‡πâ‡∏ß... ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏°‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Channels (CH)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á: ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö VP ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô? (‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢)</p>
                        <textarea id="bmc-ch" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: Online (Shopee, TikTok Shop, Brand.com), Offline (‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤, Watsons, Eveandboy)"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Customer Relationships (CR)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå: ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£/‡∏î‡∏π‡πÅ‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏≤‡∏£‡∏±‡∏Å‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå?</p>
                        <textarea id="bmc-cr" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏™‡∏£‡πâ‡∏≤‡∏á Community ‡∏Ñ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ß, ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÇ‡∏î‡∏¢‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ú‡πà‡∏≤‡∏ô TikTok, ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∞‡∏™‡∏°‡πÅ‡∏ï‡πâ‡∏°, ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ (Self-service)"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 5: The Engine (Operations) -->
            <div id="step-5-content" class="step-panel hidden bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: The Engine (‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á)</h2>

                <details class="sticky-info no-print">
                    <summary>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π VP & CS (‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3)</summary>
                    <div class="sticky-content sticky-grid">
                        <div class="sticky-block"><h5>Value Proposition:</h5><pre id="sticky-vp-2">...</pre></div>
                        <div class="sticky-block"><h5>Customer Segments:</h5><pre id="sticky-cs-2">...</pre></div>
                    </div>
                </details>
                
                <p class="text-gray-600 mb-4">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö "‡∏™‡∏±‡∏ç‡∏ç‡∏≤" (VP) ‡∏ô‡∏±‡πâ‡∏ô... ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ/‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥/‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡πÉ‡∏Ñ‡∏£?</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Key Activities (KA)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å: ‡∏ï‡πâ‡∏≠‡∏á "‡∏ó‡∏≥" ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Å‡∏¥‡∏î?</p>
                        <textarea id="bmc-ka" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: R&D (‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏£), ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î Digital (‡∏¢‡∏¥‡∏á Ads, Live), ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (QC)"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Key Resources (KR)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏´‡∏•‡∏±‡∏Å: ‡∏ï‡πâ‡∏≠‡∏á "‡∏°‡∏µ" ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?</p>
                        <textarea id="bmc-kr" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏™‡∏π‡∏ï‡∏£‡∏ï‡∏≥‡∏£‡∏±‡∏ö (IP), ‡∏ó‡∏µ‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢/‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£, Brand, ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô, ‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‡∏≠‡∏¢."></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Key Partners (KP)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏´‡∏•‡∏±‡∏Å: ‡∏ï‡πâ‡∏≠‡∏á "‡∏û‡∏∂‡πà‡∏á" ‡πÉ‡∏Ñ‡∏£‡∏ö‡πâ‡∏≤‡∏á?</p>
                        <textarea id="bmc-kp" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏¥‡∏ï (OEM), ‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î, Influencers (KOLs), ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏à‡∏±‡∏¢)"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 6: The Finance -->
            <div id="step-6-content" class="step-panel hidden bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: The Finance (‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô)</h2>

                <details class="sticky-info no-print">
                    <summary>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π VP & CS (‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3)</summary>
                    <div class="sticky-content sticky-grid">
                        <div class="sticky-block"><h5>Value Proposition:</h5><pre id="sticky-vp-3">...</pre></div>
                        <div class="sticky-block"><h5>Customer Segments:</h5><pre id="sticky-cs-3">...</pre></div>
                    </div>
                </details>

                <p class="text-gray-600 mb-4">‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ô‡∏µ‡πâ‡∏à‡∏∞ "‡∏£‡∏≠‡∏î" ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-bold text-red-800 mb-2">Cost Structure (C$)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡πÜ ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?</p>
                        <textarea id="bmc-c" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï (‡πÅ‡∏õ‡∏£‡∏ú‡∏±‡∏ô), ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (Fixed + Ads), ‡∏Ñ‡πà‡∏≤ R&D, ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á Influencer, ‡∏Ñ‡πà‡∏≤ GP ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-green-800 mb-2">Revenue Streams (R$)</h3>
                        <p class="text-sm text-gray-500 mb-2">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ó‡∏≤‡∏á‡πÑ‡∏´‡∏ô? ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?</p>
                        <textarea id="bmc-r" class="bmc-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏à‡∏•‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏¥‡∏ß (B2C/D2C), ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏≤ (B2B), ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ã‡∏£‡∏±‡πà‡∏°)"></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 7: The Full BMC (Presentation Mode) -->
            <div id="step-7-content" class="step-panel hidden">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 no-print">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 7: The Full BMC (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠)</h2>
                <p class="text-gray-600 mb-6 no-print">‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Business Model Canvas ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏∏‡∏ì [Image of Business Model Canvas] (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</p>
                
                <button id="export-pdf-btn" class="bg-green-600 text-white py-2 px-5 rounded-lg font-medium hover:bg-green-700 transition duration-300 mb-6 no-print">
                    Export (Print to PDF)
                </button>
                
                <div class="print-container">
                    <h1 id="print-title" class="hidden print:block">...</h1>
                    <div class="bmc-grid-final">
                        <div class="bmc-block-final hover-lift bmc-kp">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" /></svg>Key Partners</h3>
                            <div id="final-kp" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-ka">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.377.345-5.085.54-7.878.54-2.793 0-5.501-.195-7.878-.54-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-8.326 0c-1.069.16-1.837 1.094-1.837 2.175v4.783c0 .858.63 1.594 1.5 1.661m15.75-6.3V8.25A2.25 2.25 0 0 0 18 6h-2.25M8.25 12v8.25M3.75 16.5h1.5m15-11.25h-15" /></svg>Key Activities</h3>
                            <div id="final-ka" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-vp">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 3.75v16.5m0-16.5a2.25 2.25 0 0 0-2.25-2.25h-1.5a2.25 2.25 0 0 0-2.25 2.25m4.5 0v16.5h-4.5v-16.5m0 0a2.25 2.25 0 0 1-2.25-2.25h1.5a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1-2.25 2.25m0 0a2.25 2.25 0 0 1 2.25-2.25m-2.25 2.25a2.25 2.25 0 0 0 2.25 2.25m-2.25-2.25a2.25 2.25 0 0 1-2.25-2.25m2.25 2.25a2.25 2.25 0 0 0-2.25-2.25m6 7.5a2.25 2.25 0 0 1-2.25 2.25m0 0a2.25 2.25 0 0 1-2.25-2.25m2.25 2.25a2.25 2.25 0 0 0 2.25 2.25m-2.25-2.25a2.25 2.25 0 0 1 2.25-2.25m0 0a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1-2.25 2.25m-2.25 2.25a2.25 2.25 0 0 0-2.25 2.25m2.25-2.25a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1 2.25 2.25M6 15a2.25 2.25 0 0 1-2.25 2.25m0 0a2.25 2.25 0 0 1-2.25-2.25m2.25 2.25a2.25 2.25 0 0 0 2.25 2.25m-2.25-2.25a2.25 2.25 0 0 1 2.25-2.25m0 0a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1-2.25 2.25m-2.25 2.25a2.25 2.25 0 0 0-2.25 2.25m2.25-2.25a2.25 2.25 0 0 1 2.25 2.25m0 0a2.25 2.25 0 0 1 2.25 2.25" /></svg>Value Proposition</h3>
                            <div id="final-vp" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-cr">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" /></svg>Customer Relationships</h3>
                            <div id="final-cr" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-cs">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.5a1.5 1.5 0 0 0-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m-9.75-5.25A1.5 1.5 0 0 1 6.75 12H17.25a1.5 1.5 0 0 1 1.5 1.5v3.75a1.5 1.5 0 0 1-1.5 1.5H6.75a1.5 1.5 0 0 1-1.5-1.5v-3.75Zm0 0V11.25a1.5 1.5 0 0 1 1.5-1.5h9.75a1.5 1.5 0 0 1 1.5 1.5v1.5m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m6.75-3.75a1.5 1.5 0 0 0-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m-9.75 3.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m9.75-3.75a1.5 1.5 0 0 0-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3m-6.75-3.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-3Z" /></svg>Customer Segments</h3>
                            <div id="final-cs" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-kr">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v-2.25l1.9-1.9a1.5 1.5 0 0 1 2.12 0l1.5 1.5m-1.5-1.5a1.5 1.5 0 0 1 2.12 0l1.5 1.5m0 0a1.5 1.5 0 0 1 0 2.12l-1.5 1.5m-1.5-1.5a1.5 1.5 0 0 1 0-2.12l1.5-1.5m-1.5-1.5a1.5 1.5 0 0 1-2.12 0l-1.5-1.5m1.5 1.5a1.5 1.5 0 0 1-2.12 0l-1.5-1.5M15.75 5.25a3 3 0 0 0-3-3m0 0a6 6 0 0 0-7.029 5.912c.563-.097 1.159.026 1.563.43L8.25 9.75H6v2.25l-1.9 1.9a1.5 1.5 0 0 0 0 2.12l1.5 1.5m1.5-1.5a1.5 1.5 0 0 0 0 2.12l-1.5 1.5m1.5-1.5a1.5 1.5 0 0 0-2.12 0l-1.5 1.5m1.5 1.5a1.5 1.5 0 0 0-2.12 0L3 17.25v-2.25l1.9-1.9a1.5 1.5 0 0 0-2.12-2.12l-1.5-1.5m1.5 1.5a1.5 1.5 0 0 0-2.12-2.12L3 8.25v-2.25l1.9-1.9a1.5 1.5 0 0 1 2.12 0l1.5 1.5m1.5-1.5a1.5 1.5 0 0 1 2.12 0l1.5 1.5m1.5-1.5a1.5 1.5 0 0 1 2.12 0l1.5 1.5m0 0a1.5 1.5 0 0 1 0-2.12L15 8.25v-2.25l1.9-1.9a1.5 1.5 0 0 0 0-2.12l-1.5-1.5m-1.5 1.5a1.5 1.5 0 0 0 0-2.12L15 3.75v-2.25l1.9-1.9a1.5 1.5 0 0 1 2.12 0l1.5 1.5m-1.5 1.5a1.5 1.5 0 0 1 2.12 0l1.5 1.5m-1.5 1.5a1.5 1.5 0 0 1 0 2.12L18 8.25v2.25l-1.9 1.9a1.5 1.5 0 0 1-2.12 0l-1.5-1.5Z" /></svg>Key Resources</h3>
                            <div id="final-kr" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-ch">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6.75m-6.75 0h6.75m6.75-6.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h-6.75m6.75 0h-6.75M3 12h18M3.75 7.5h16.5M10.5 2.25h3M3.75 2.25h16.5M10.5 21.75h3M3.75 21.75h16.5" /></svg>Channels</h3>
                            <div id="final-ch" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-c">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 8.25H9m6 3H9m3 6.75H9m3.75 3H9m10.5-3.75V15a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 15v3.75m18 0V15A2.25 2.25 0 0 0 18.75 12.75H5.25A2.25 2.25 0 0 0 3 15v3.75m18 0v-3.75a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 15v3.75m18 0v-3.75a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 15v3.75M3 15v-3.75a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 11.25v3.75m-18 0v-3.75a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 11.25v3.75m-18 0h18" /></svg>Cost Structure</h3>
                            <div id="final-c" class="bmc-block-final-content"></div>
                        </div>
                        <div class="bmc-block-final hover-lift bmc-r">
                            <h3><svg class="bmc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1-1.414 1.414l-4.306-4.306Zm0 0L21.75 3" /></svg>Revenue Streams</h3>
                            <div id="final-r" class="bmc-block-final-content"></div>
                        </div>
                    </div>
                </div>

                <div id="visualization-panel" class="bg-white p-6 rounded-lg shadow-xl mt-6 no-print hover-lift">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center space-x-2">
                        <span>üìä</span><span>Data Visualization</span>
                    </h3>
                    <canvas id="bmc-chart" height="220"></canvas>
                    <p class="text-sm text-gray-500 mt-3">‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á Business Model Canvas ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
                </div>
            </div>

        </div>

        <!-- Navigation Buttons -->
        <div id="nav-buttons-container" class="flex justify-between mt-8 no-print">
            <button id="back-btn" class="bg-gray-500 text-white py-2 px-6 rounded-lg font-medium hover:bg-gray-600 transition duration-300">
                ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
            </button>
            <button id="next-btn" class="bg-blue-600 text-white py-2 px-6 rounded-lg font-medium hover:bg-blue-700 transition duration-300">
                ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ
            </button>
        </div>

        <!-- Footer -->
        <footer class="mt-12 text-center text-sm text-gray-500 no-print">
            <div class="flex items-center justify-center space-x-2">
                <img src="https://i.postimg.cc/yY1rPJ07/wirun_facbook.png" alt="Logo" class="w-8 h-8 rounded-full">
                <span>Designed by ‡∏†‡∏Å.‡∏ß‡∏¥‡∏£‡∏∏‡∏ì ‡πÄ‡∏ß‡∏ä‡∏®‡∏¥‡∏£‡∏¥</span>
            </div>
        </footer>
    </div>

    <!-- Compare Modal -->
    <div id="compare-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center hidden no-print z-50">
        <div class="modal-card bg-white w-full max-w-4xl p-6 rounded-xl shadow-2xl relative">
            <button id="close-compare-modal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl leading-none">&times;</button>
            <h3 class="text-2xl font-semibold text-gray-800 mb-4">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°</h3>
            <div class="grid md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">‡∏Å‡∏•‡∏∏‡πà‡∏° A</label>
                    <select id="compare-select-a" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500"></select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-600 mb-1">‡∏Å‡∏•‡∏∏‡πà‡∏° B</label>
                    <select id="compare-select-b" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500"></select>
                </div>
            </div>
            <button id="run-compare-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</button>
            <div id="compare-results" class="mt-6 max-h-80 overflow-y-auto space-y-3"></div>
        </div>
    </div>

    <!-- Template Modal -->
    <div id="template-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center hidden no-print z-40">
        <div class="modal-card bg-white w-full max-w-4xl p-6 rounded-xl shadow-2xl relative">
            <button id="close-template-modal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl leading-none">&times;</button>
            <h3 class="text-2xl font-semibold text-gray-800 mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</h3>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50">
                    <h4 class="text-lg font-bold text-purple-700 mb-2">Skincare / Acne Care</h4>
                    <p class="text-sm text-gray-600 mb-3">‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏¥‡∏ß ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö</p>
                    <button class="template-select-btn bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700" data-template="skincare">‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
                </div>
                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50">
                    <h4 class="text-lg font-bold text-blue-700 mb-2">Sleep Well Blend</h4>
                    <p class="text-sm text-gray-600 mb-3">‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö ‡πÄ‡∏ô‡πâ‡∏ô‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>
                    <button class="template-select-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700" data-template="sleep">‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
                </div>
                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50">
                    <h4 class="text-lg font-bold text-green-700 mb-2">Energy Shot</h4>
                    <p class="text-sm text-gray-600 mb-3">‡∏ä‡πá‡∏≠‡∏ï‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å</p>
                    <button class="template-select-btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700" data-template="energy">‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
                </div>
                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50">
                    <h4 class="text-lg font-bold text-orange-700 mb-2">Immune Booster Tea</h4>
                    <p class="text-sm text-gray-600 mb-3">‡∏ä‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</p>
                    <button class="template-select-btn bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600" data-template="immune">‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï‡∏ô‡∏µ‡πâ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const groupSelectContainer = document.getElementById('group-select-container');
            const appContainer = document.getElementById('app-container');
            const groupNameInput = document.getElementById('group-name-input');
            const startBtn = document.getElementById('start-workshop-btn');
            const groupInfo = document.getElementById('group-info');
            const navTabs = document.querySelectorAll('.nav-tab');
            const stepPanels = document.querySelectorAll('.step-panel');
            const resetBtn = document.getElementById('reset-data-btn');
            const nextBtn = document.getElementById('next-btn');
            const backBtn = document.getElementById('back-btn');
            const exportPdfBtn = document.getElementById('export-pdf-btn');
            const printTitle = document.getElementById('print-title');
            const navButtonsContainer = document.getElementById('nav-buttons-container');
            const progressBarEl = document.getElementById('progress-bar');
            const progressContainer = document.getElementById('progress-container');
            const progressSteps = document.querySelectorAll('.progress-step');
            const groupSwitcher = document.getElementById('group-switcher');
            const loadGroupBtn = document.getElementById('load-group-btn');
            const compareGroupsBtn = document.getElementById('compare-groups-btn');
            const historyList = document.getElementById('history-list');
            const undoBtn = document.getElementById('undo-btn');
            const redoBtn = document.getElementById('redo-btn');
            const backupAllBtn = document.getElementById('backup-all-btn');
            const restoreBackupInput = document.getElementById('restore-backup-input');
            const screenshotBtn = document.getElementById('screenshot-btn');
            const shareBtn = document.getElementById('share-btn');
            const visualizeBtn = document.getElementById('visualize-btn');
            const landingGroupList = document.getElementById('landing-group-list');
            const compareModal = document.getElementById('compare-modal');
            const closeCompareModal = document.getElementById('close-compare-modal');
            const compareSelectA = document.getElementById('compare-select-a');
            const compareSelectB = document.getElementById('compare-select-b');
            const runCompareBtn = document.getElementById('run-compare-btn');
            const compareResults = document.getElementById('compare-results');
            const templateModal = document.getElementById('template-modal');
            const closeTemplateModal = document.getElementById('close-template-modal');
            const templateSelectButtons = document.querySelectorAll('.template-select-btn');
            const aiForm = document.getElementById('ai-form');
            const aiPromptInput = document.getElementById('ai-prompt');
            const aiContextInput = document.getElementById('ai-context');
            const aiToneSelect = document.getElementById('ai-tone');
            const aiDeliverableSelect = document.getElementById('ai-deliverable');
            const aiIncludeBmcCheckbox = document.getElementById('ai-use-bmc');
            const aiStatus = document.getElementById('ai-status');
            const aiOutput = document.getElementById('ai-output');
            const aiError = document.getElementById('ai-error');
            const aiCopyBtn = document.getElementById('ai-copy-btn');
            const aiResetOutputBtn = document.getElementById('ai-reset-output');
            const aiClearHistoryBtn = document.getElementById('ai-clear-history');
            const aiHistoryList = document.getElementById('ai-history');

            const bmcFields = [
                'lab', 
                'vpc-jobs', 'vpc-pains', 'vpc-gains', 
                'vpc-products', 'vpc-relievers', 'vpc-creators',
                'vp', 'cs', 'ch', 'cr', 'ka', 'kr', 'kp', 'c', 'r'
            ];

            const finalBmcFields = ['kp', 'ka', 'vp', 'cr', 'cs', 'kr', 'ch', 'c', 'r'];
            const finalFieldHints = {
                kp: '‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏´‡∏•‡∏±‡∏Å (Key Partners) ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤',
                ka: '‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Key Activities) ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                vp: '‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ Value Proposition ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏∏‡∏ì',
                cr: '‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Customer Relationship ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á',
                cs: '‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£ ‡∏°‡∏µ Insight ‡∏≠‡∏∞‡πÑ‡∏£',
                kr: '‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ',
                ch: '‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',
                c: '‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (Cost Structure)',
                r: '‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ / ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Revenue Streams)'
            };
            const fieldLabels = {
                lab: 'Scientific Evidence',
                'vpc-jobs': 'Customer Jobs',
                'vpc-pains': 'Customer Pains',
                'vpc-gains': 'Customer Gains',
                'vpc-products': 'Products & Services',
                'vpc-relievers': 'Pain Relievers',
                'vpc-creators': 'Gain Creators',
                vp: 'Value Proposition',
                cs: 'Customer Segments',
                ch: 'Channels',
                cr: 'Customer Relationships',
                ka: 'Key Activities',
                kr: 'Key Resources',
                kp: 'Key Partners',
                c: 'Cost Structure',
                r: 'Revenue Streams'
            };
            const AI_HISTORY_KEY = 'bmc-ai-history';
            const AI_HISTORY_LIMIT = 8;
            const DEFAULT_AI_OUTPUT = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å Typhoon';
            const aiDeliverableConfig = {
                'brand-story': {
                    label: 'Brand Story / Narrative',
                    instruction: 'Craft a vivid, human brand story that links customer pains/gains to the solution and ends with a motivating CTA.'
                },
                'campaign-ideas': {
                    label: 'Campaign Concepts',
                    instruction: 'Propose 2-3 campaign ideas with hooks, sample taglines, and recommended channels.'
                },
                'customer-insight': {
                    label: 'Customer Insight Summary',
                    instruction: 'Summarize the key customer insights, tensions, and opportunities observed.'
                },
                'value-prop': {
                    label: 'Value Proposition Rewrite',
                    instruction: 'Rewrite or sharpen the value proposition in 2-3 punchy paragraphs with bullets for proof points.'
                },
                'gtm-brief': {
                    label: 'Go-to-Market Checklist',
                    instruction: 'Outline a concise GTM action plan with channels, key activities, owners, and success metrics.'
                }
            };
            const aiToneConfig = {
                inspiring: {
                    label: 'Inspiring Visionary',
                    description: 'Visionary, hopeful, energetic and slightly poetic without losing clarity.'
                },
                practical: {
                    label: 'Practical & Actionable',
                    description: 'Direct, structured, and focused on clear next steps with measurable outcomes.'
                },
                playful: {
                    label: 'Playful & Friendly',
                    description: 'Upbeat, conversational, with tasteful humor that still respects professional context.'
                },
                formal: {
                    label: 'Formal & Executive',
                    description: 'Crisp, executive-ready language suitable for stakeholders and board updates.'
                }
            };
            
            let currentGroup = null;
            let currentGroupName = "";
            let currentStep = 1;
            const totalSteps = 7;
            const STORAGE_PREFIX = 'bmc-workshop-group-';
            const STORAGE_VERSION = 2;
            const HISTORY_LIMIT = 20;
            let currentHistory = [];
            let historyIndex = -1;
            let latestSnapshot = {};
            const chartCanvas = document.getElementById('bmc-chart');
            let bmcChartInstance = null;

            function escapeHtml(str = '') {
                const map = {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#39;'
                };
                return str.replace(/[&<>"']/g, char => map[char]);
            }

            function getEmptyStateMarkup(hint) {
                const safeHint = escapeHtml(hint);
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <p class="empty-state-hint">${safeHint}</p>
                    </div>
                `;
            }

            function renderFinalBlock(field, value = '') {
                const element = document.getElementById(`final-${field}`);
                if (!element) return;
                const hint = finalFieldHints[field] || '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢';

                if (value && value.trim()) {
                    element.classList.remove('empty');
                    element.textContent = value;
                } else {
                    element.classList.add('empty');
                    element.innerHTML = getEmptyStateMarkup(hint);
                }
            }

            function normalizePayload(rawData, fallbackName = '') {
                if (!rawData) return null;
                try {
                    const parsed = JSON.parse(rawData);
                    if (parsed && typeof parsed === 'object' && 'data' in parsed) {
                        return {
                            version: parsed.version || 1,
                            data: parsed.data || {},
                            history: Array.isArray(parsed.history) ? parsed.history : [],
                            lastSaved: parsed.lastSaved || null,
                            groupName: parsed.groupName || fallbackName
                        };
                    }
                    return {
                        version: 1,
                        data: parsed || {},
                        history: [],
                        lastSaved: null,
                        groupName: fallbackName
                    };
                } catch (error) {
                    console.error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ', error);
                    return null;
                }
            }

            function formatTimestamp(timestamp) {
                if (!timestamp) return '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
                const date = new Date(timestamp);
                return date.toLocaleString('th-TH', { dateStyle: 'short', timeStyle: 'short' });
            }

            function getAiHistory() {
                try {
                    const raw = localStorage.getItem(AI_HISTORY_KEY);
                    const parsed = raw ? JSON.parse(raw) : [];
                    return Array.isArray(parsed) ? parsed : [];
                } catch (error) {
                    console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ AI ‡πÑ‡∏î‡πâ', error);
                    return [];
                }
            }

            function saveAiHistory(entries) {
                try {
                    localStorage.setItem(AI_HISTORY_KEY, JSON.stringify(entries.slice(0, AI_HISTORY_LIMIT)));
                } catch (error) {
                    console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ AI ‡πÑ‡∏î‡πâ', error);
                }
            }

            function renderAiHistory(entries = getAiHistory()) {
                if (!aiHistoryList) return;
                if (!entries.length) {
                    aiHistoryList.innerHTML = '<p class="text-xs text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô AI</p>';
                    return;
                }
                aiHistoryList.innerHTML = entries.map(entry => {
                    const safePrompt = escapeHtml(entry.prompt || '');
                    const safeDeliverable = escapeHtml(entry.deliverableLabel || entry.deliverable || 'Request');
                    const safeTone = escapeHtml(entry.toneLabel || entry.tone || '');
                    const timestamp = entry.timestamp ? new Date(entry.timestamp).toLocaleString('th-TH', { dateStyle: 'short', timeStyle: 'short' }) : '';
                    return `
                        <div class="p-3 rounded-xl bg-white/80 dark:bg-slate-900/60 border border-gray-100 dark:border-slate-800">
                            <p class="text-[10px] uppercase tracking-wide text-indigo-500 font-semibold">${safeDeliverable}</p>
                            <p class="text-xs text-gray-400 mt-0.5">${safeTone}</p>
                            <p class="text-sm text-gray-700 dark:text-gray-200 mt-2 leading-relaxed">${safePrompt}</p>
                            <p class="text-[10px] text-gray-400 mt-2">${escapeHtml(timestamp)}</p>
                        </div>
                    `;
                }).join('');
            }

            function getBmcSnapshotForAi() {
                const rows = [];
                bmcFields.forEach(field => {
                    const el = document.getElementById(`bmc-${field}`);
                    if (el && el.value && el.value.trim()) {
                        const label = fieldLabels[field] || field;
                        rows.push(`${label}: ${el.value.trim()}`);
                    }
                });
                if (!rows.length) return '';
                const snapshot = rows.join('\n');
                return snapshot.length > 2500 ? `${snapshot.slice(0, 2500)}...` : snapshot;
            }

            function buildAiMessages({ prompt, context, toneKey, deliverableKey, includeBmc }) {
                const deliverable = aiDeliverableConfig[deliverableKey] || aiDeliverableConfig['brand-story'];
                const tone = aiToneConfig[toneKey] || aiToneConfig.inspiring;
                const sections = [
                    `Deliverable requested: ${deliverable.label}. ${deliverable.instruction}`,
                    `Preferred voice: ${tone.description}`,
                    `Primary request: ${prompt.trim()}`
                ];
                if (context && context.trim()) {
                    sections.push(`Additional context: ${context.trim()}`);
                }
                if (includeBmc) {
                    const snapshot = getBmcSnapshotForAi();
                    if (snapshot) {
                        sections.push(`Business Model Canvas data (use only if relevant):\n${snapshot}`);
                    }
                }
                sections.push('The interface is Thai-first. Reply in Thai unless the prompt clearly uses another language. Use short sections with headings and bullet points when useful.');
                return [
                    {
                        role: 'system',
                        content: 'You are an AI assistant named Typhoon created by SCB 10X to be helpful, harmless, and honest. Typhoon is happy to help with analysis, question answering, math, coding, creative writing, teaching, role-play, general discussion, and all sorts of other tasks. Typhoon responds directly to all human messages without unnecessary affirmations or filler phrases like "Certainly!", "Of course!", "Absolutely!", "Great!", "Sure!", etc. Specifically, Typhoon avoids starting responses with the word "Certainly" in any way. Typhoon follows this information in all languages, and always responds to the user in the language they use or request. Typhoon is now being connected with a human. Write in fluid, conversational prose, Show genuine interest in understanding requests, Express appropriate emotions and empathy.'
                    },
                    {
                        role: 'user',
                        content: sections.join('\n\n')
                    }
                ];
            }

            async function callTyphoon(messages) {
                const endpoints = ['/api/ai', '/.netlify/functions/ai'];
                let lastError = null;
                for (const endpoint of endpoints) {
                    try {
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ messages })
                        });
                        if (!response.ok) {
                            const errorText = await response.text();
                            let parsedMessage = errorText;
                            try {
                                const parsed = JSON.parse(errorText);
                                parsedMessage = parsed?.error || parsed?.message || parsed?.details || errorText;
                            } catch (error) {
                                // ignore JSON parse errors
                            }
                            throw new Error(parsedMessage || `Typhoon API error (${response.status})`);
                        }
                        return await response.json();
                    } catch (error) {
                        lastError = error;
                    }
                }
                throw lastError || new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Typhoon ‡πÑ‡∏î‡πâ');
            }

            function setAiLoading(isLoading) {
                if (!aiForm) return;
                const submitBtn = aiForm.querySelector('button[type="submit"]');
                if (submitBtn) {
                    if (!submitBtn.dataset.defaultText) {
                        submitBtn.dataset.defaultText = submitBtn.textContent;
                    }
                    submitBtn.disabled = isLoading;
                    submitBtn.classList.toggle('opacity-60', isLoading);
                    submitBtn.textContent = isLoading ? 'Typhoon ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î...' : submitBtn.dataset.defaultText;
                }
                if (aiStatus) {
                    aiStatus.classList.toggle('hidden', !isLoading);
                }
            }

            function showAiError(message) {
                if (!aiError) return;
                aiError.textContent = message;
                aiError.classList.remove('hidden');
            }

            function hideAiError() {
                if (!aiError) return;
                aiError.classList.add('hidden');
                aiError.textContent = '';
            }

            function updateAiOutput(text) {
                if (!aiOutput) return;
                const safeText = escapeHtml(text || '');
                aiOutput.innerHTML = safeText.replace(/\\n/g, '<br>');
            }

            function resetAiOutput() {
                if (!aiOutput) return;
                aiOutput.textContent = DEFAULT_AI_OUTPUT;
            }

            async function handleAiSubmit(event) {
                event.preventDefault();
                if (!aiForm) return;
                const prompt = (aiPromptInput?.value || '').trim();
                if (!prompt) {
                    showAiError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£');
                    aiPromptInput?.focus();
                    return;
                }

                const context = (aiContextInput?.value || '').trim();
                const toneKey = aiToneSelect?.value || 'inspiring';
                const deliverableKey = aiDeliverableSelect?.value || 'brand-story';
                const includeBmc = !!aiIncludeBmcCheckbox?.checked;

                hideAiError();
                setAiLoading(true);
                try {
                    const messages = buildAiMessages({
                        prompt,
                        context,
                        toneKey,
                        deliverableKey,
                        includeBmc
                    });
                    const data = await callTyphoon(messages);
                    const aiText = data?.choices?.[0]?.message?.content?.trim();
                    if (!aiText) {
                        throw new Error('Typhoon ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤');
                    }
                    updateAiOutput(aiText);
                    const history = [
                        {
                            prompt,
                            deliverable: deliverableKey,
                            deliverableLabel: aiDeliverableConfig[deliverableKey]?.label,
                            tone: toneKey,
                            toneLabel: aiToneConfig[toneKey]?.label,
                            timestamp: Date.now()
                        },
                        ...getAiHistory()
                    ].slice(0, AI_HISTORY_LIMIT);
                    saveAiHistory(history);
                    renderAiHistory(history);
                } catch (error) {
                    console.error('AI request failed', error);
                    showAiError(error.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Typhoon ‡πÑ‡∏î‡πâ');
                } finally {
                    setAiLoading(false);
                }
            }

            async function copyAiOutput() {
                if (!aiOutput) return;
                const text = aiOutput.innerText.trim();
                if (!text || text === DEFAULT_AI_OUTPUT) {
                    showAiError('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å');
                    return;
                }
                try {
                    if (navigator.clipboard?.writeText) {
                        await navigator.clipboard.writeText(text);
                    } else {
                        const textarea = document.createElement('textarea');
                        textarea.value = text;
                        document.body.appendChild(textarea);
                        textarea.select();
                        document.execCommand('copy');
                        textarea.remove();
                    }
                } catch (error) {
                    console.error('Copy failed', error);
                    showAiError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ');
                    return;
                }
                hideAiError();
                if (aiCopyBtn) {
                    const original = aiCopyBtn.textContent;
                    aiCopyBtn.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                    aiCopyBtn.disabled = true;
                    setTimeout(() => {
                        aiCopyBtn.textContent = original || '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å';
                        aiCopyBtn.disabled = false;
                    }, 1500);
                }
            }

            function clearAiHistory() {
                saveAiHistory([]);
                renderAiHistory([]);
            }

            function listSavedGroups() {
                const groups = [];
                for (let i = 0; i < localStorage.length; i += 1) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith(STORAGE_PREFIX)) {
                        const prettyName = key.replace(STORAGE_PREFIX, '').replace(/_/g, ' ');
                        const payload = normalizePayload(localStorage.getItem(key), prettyName);
                        if (payload) {
                            groups.push({
                                key,
                                name: payload.groupName || prettyName,
                                lastSaved: payload.lastSaved || 0
                            });
                        }
                    }
                }
                return groups.sort((a, b) => (b.lastSaved || 0) - (a.lastSaved || 0));
            }

            function renderLandingGroups(groups) {
                if (!landingGroupList) return;
                landingGroupList.innerHTML = '';
                if (!groups.length) {
                    landingGroupList.innerHTML = '<p class="text-sm text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>';
                    return;
                }
                groups.slice(0, 5).forEach(group => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = 'w-full border border-gray-200 rounded-lg px-3 py-2 text-left hover:border-blue-500 hover:bg-blue-50 transition';
                    button.textContent = `${group.name} ‚Ä¢ ${formatTimestamp(group.lastSaved)}`;
                    button.addEventListener('click', () => {
                        groupNameInput.value = group.name;
                        initializeWorkshop();
                    });
                    landingGroupList.appendChild(button);
                });
            }

            function refreshGroupList() {
                const groups = listSavedGroups();
                if (groupSwitcher) {
                    groupSwitcher.innerHTML = '<option value=\"\">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</option>';
                    groups.forEach(group => {
                        const option = document.createElement('option');
                        option.value = group.key;
                        option.textContent = `${group.name} ‚Ä¢ ${formatTimestamp(group.lastSaved)}`;
                        groupSwitcher.appendChild(option);
                    });
                    const currentKey = getStorageKey();
                    if (currentKey) {
                        groupSwitcher.value = currentKey;
                    }
                }
                renderLandingGroups(groups);
                return groups;
            }

            function refreshHistoryList() {
                if (!historyList) return;
                historyList.innerHTML = '';
                if (!currentHistory.length) {
                    historyList.innerHTML = '<p class="text-gray-400 text-xs">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>';
                    return;
                }

                const timeline = currentHistory.map((entry, idx) => ({ entry, idx })).reverse();
                timeline.forEach(({ entry, idx }) => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = `w-full text-left px-3 py-2 rounded-lg border transition ${idx === historyIndex ? 'border-blue-500 bg-blue-50' : 'border-transparent hover:bg-gray-100'}`;
                    button.innerHTML = `
                        <span class="block text-sm font-semibold text-gray-700">${formatTimestamp(entry.timestamp)}</span>
                        <span class="text-xs text-gray-500">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ${Object.keys(entry.data || {}).filter(key => entry.data[key]?.trim()).length} ‡∏ä‡πà‡∏≠‡∏á</span>
                    `;
                    button.addEventListener('click', () => {
                        historyIndex = idx;
                        applySnapshot(entry);
                    });
                    historyList.appendChild(button);
                });
            }

            function updateVisualization(data = {}) {
                if (!chartCanvas || typeof Chart === 'undefined') return;
                const ctx = chartCanvas.getContext('2d');
                const labels = finalBmcFields.map(field => fieldLabels[field]);
                const dataset = finalBmcFields.map(field => (data[field] || '').trim().length);

                if (!bmcChartInstance) {
                    bmcChartInstance = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels,
                            datasets: [{
                                label: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                                data: dataset,
                                backgroundColor: 'rgba(37, 99, 235, 0.2)',
                                borderColor: 'rgba(37, 99, 235, 0.8)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(37, 99, 235, 1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    ticks: { display: false }
                                }
                            }
                        }
                    });
                } else {
                    bmcChartInstance.data.labels = labels;
                    bmcChartInstance.data.datasets[0].data = dataset;
                    bmcChartInstance.update();
                }
            }

            function applySnapshot(entry) {
                if (!entry || !entry.data) return;
                bmcFields.forEach(field => {
                    const el = document.getElementById(`bmc-${field}`);
                    if (el) {
                        el.value = entry.data[field] || '';
                    }
                });
                latestSnapshot = { ...entry.data };
                updateStickyInfo(latestSnapshot);
                refreshAllCharCounters();
                populateFinalBMC(latestSnapshot);
                updateVisualization(latestSnapshot);
                saveData({ skipHistory: true, externalData: latestSnapshot });
            }

            function undoChange() {
                if (!currentHistory.length || historyIndex <= 0) {
                    alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß');
                    return;
                }
                historyIndex -= 1;
                applySnapshot(currentHistory[historyIndex]);
                refreshHistoryList();
            }

            function redoChange() {
                if (!currentHistory.length || historyIndex >= currentHistory.length - 1) {
                    alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß');
                    return;
                }
                historyIndex += 1;
                applySnapshot(currentHistory[historyIndex]);
                refreshHistoryList();
            }

            function collectShareSummary(data = {}) {
                return [
                    `‡∏Å‡∏•‡∏∏‡πà‡∏°: ${currentGroupName || '-'}`,
                    `Value Proposition: ${data.vp || '-'}`,
                    `Customer Segments: ${data.cs || '-'}`,
                    `Channels: ${data.ch || '-'}`,
                    `Revenue Streams: ${data.r || '-'}`
                ].join('\\n');
            }

            async function shareCurrentSnapshot() {
                if (!latestSnapshot || !Object.keys(latestSnapshot).length) {
                    alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏ä‡∏£‡πå');
                    return;
                }
                const summary = collectShareSummary(latestSnapshot);
                if (navigator.share) {
                    try {
                        await navigator.share({
                            title: `Brand Lab - ${currentGroupName || 'Untitled'}`,
                            text: summary
                        });
                    } catch (error) {
                        if (error && error.name !== 'AbortError') {
                            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ');
                        }
                    }
                } else if (navigator.clipboard) {
                    try {
                        await navigator.clipboard.writeText(summary);
                        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß');
                    } catch (error) {
                        alert('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥');
                    }
                } else {
                    alert(summary);
                }
            }

            async function captureScreenshot() {
                if (typeof html2canvas === 'undefined') {
                    alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ (html2canvas ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)');
                    return;
                }
                const target = document.getElementById(`step-${currentStep}-content`) || appContainer;
                const canvas = await html2canvas(target, { backgroundColor: null });
                canvas.toBlob(blob => {
                    if (!blob) return;
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `brand-lab-${currentGroupName || 'snapshot'}.png`;
                    document.body.appendChild(link);
                    link.click();
                    link.remove();
                    setTimeout(() => URL.revokeObjectURL(url), 500);
                });
            }

            function populateCompareSelectors() {
                if (!compareSelectA || !compareSelectB) return;
                const groups = refreshGroupList();
                const createOptions = select => {
                    select.innerHTML = '<option value=\"\">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°</option>';
                    groups.forEach(group => {
                        const option = document.createElement('option');
                        option.value = group.key;
                        option.textContent = `${group.name} ‚Ä¢ ${formatTimestamp(group.lastSaved)}`;
                        select.appendChild(option);
                    });
                };
                createOptions(compareSelectA);
                createOptions(compareSelectB);
                if (compareResults) {
                    compareResults.innerHTML = '<p class="text-sm text-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö"</p>';
                }
            }

            function runComparisonAnalysis() {
                const keyA = compareSelectA?.value;
                const keyB = compareSelectB?.value;
                if (!keyA || !keyB || keyA === keyB) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô');
                    return;
                }
                const payloadA = normalizePayload(localStorage.getItem(keyA));
                const payloadB = normalizePayload(localStorage.getItem(keyB));
                if (!payloadA || !payloadB) {
                    alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å');
                    return;
                }
                const nameA = payloadA.groupName || keyA.replace(STORAGE_PREFIX, '').replace(/_/g, ' ');
                const nameB = payloadB.groupName || keyB.replace(STORAGE_PREFIX, '').replace(/_/g, ' ');
                const dataA = payloadA.data || {};
                const dataB = payloadB.data || {};

                compareResults.innerHTML = finalBmcFields.map(field => {
                    const valueA = escapeHtml(dataA[field] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                    const valueB = escapeHtml(dataB[field] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                    return `
                        <div class="border border-gray-200 rounded-lg p-3">
                            <div class="font-semibold text-gray-700 mb-2">${fieldLabels[field]}</div>
                            <div class="grid md:grid-cols-2 gap-3 text-sm">
                                <div>
                                    <p class="text-gray-500 font-medium mb-1">${escapeHtml(nameA)}</p>
                                    <div class="whitespace-pre-wrap text-gray-800">${valueA}</div>
                                </div>
                                <div>
                                    <p class="text-gray-500 font-medium mb-1">${escapeHtml(nameB)}</p>
                                    <div class="whitespace-pre-wrap text-gray-800">${valueB}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            function backupAllGroups() {
                const groups = listSavedGroups();
                if (!groups.length) {
                    alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Backup');
                    return;
                }
                const bundle = groups.map(group => {
                    const payload = normalizePayload(localStorage.getItem(group.key), group.name) || { data: {} };
                    return {
                        key: group.key,
                        version: payload.version || STORAGE_VERSION,
                        data: payload.data || {},
                        history: payload.history || [],
                        lastSaved: payload.lastSaved || Date.now(),
                        groupName: payload.groupName || group.name
                    };
                });
                const blob = new Blob([JSON.stringify(bundle, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `brand-lab-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                link.remove();
                setTimeout(() => URL.revokeObjectURL(url), 500);
            }

            function restoreBackupFromFile(file) {
                if (!file) return;
                const reader = new FileReader();
                reader.onload = e => {
                    try {
                        const payload = JSON.parse(e.target.result);
                        if (!Array.isArray(payload)) {
                            throw new Error('invalid');
                        }
                        payload.forEach(entry => {
                            if (entry.key && entry.data) {
                                const record = {
                                    version: entry.version || STORAGE_VERSION,
                                    data: entry.data,
                                    history: Array.isArray(entry.history) ? entry.history : [],
                                    lastSaved: entry.lastSaved || Date.now(),
                                    groupName: entry.groupName || entry.key.replace(STORAGE_PREFIX, '').replace(/_/g, ' ')
                                };
                                localStorage.setItem(entry.key, JSON.stringify(record));
                            }
                        });
                        alert('‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß');
                        refreshGroupList();
                    } catch (error) {
                        alert('‡πÑ‡∏ü‡∏•‡πå Backup ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                    } finally {
                        restoreBackupInput.value = '';
                    }
                };
                reader.readAsText(file);
            }

            // --- Core Functions ---

            function initializeWorkshop() {
                currentGroupName = groupNameInput.value.trim();
                if (!currentGroupName) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö');
                    return;
                }
                currentGroup = currentGroupName.replace(/[^a-z0-9]/gi, '_'); // Create a safe key

                groupSelectContainer.classList.add('hidden');
                appContainer.classList.remove('hidden');
                if (progressContainer) {
                    progressContainer.classList.remove('hidden');
                }
                document.body.classList.add('has-progress');

                groupInfo.textContent = `${currentGroupName}`;
                printTitle.textContent = `Business Model Canvas: ${currentGroupName}`;

                const storageKey = getStorageKey();
                const hasExistingData = storageKey ? localStorage.getItem(storageKey) : null;
                loadData();
                showStep(1);
                if (!hasExistingData) {
                    saveData();
                }
            }

            function showStep(step) {
                currentStep = parseInt(step);
                
                stepPanels.forEach(panel => {
                    panel.classList.add('hidden');
                });
                
                const activePanel = document.getElementById(`step-${currentStep}-content`);
                if (activePanel) {
                    activePanel.classList.remove('hidden');
                }

                // Update Tabs
                navTabs.forEach(tab => {
                    if (parseInt(tab.dataset.step) === currentStep) {
                        tab.className = 'nav-tab flex-shrink-0 text-blue-600 border-b-2 font-medium border-blue-600 py-3 px-4';
                    } else {
                        tab.className = 'nav-tab flex-shrink-0 text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 font-medium border-transparent py-3 px-4';
                    }
                });

                // Update Nav Buttons
                if (currentStep === 1) {
                    backBtn.classList.add('hidden');
                } else {
                    backBtn.classList.remove('hidden');
                }

                if (currentStep === totalSteps) {
                    nextBtn.classList.add('hidden');
                    populateFinalBMC(latestSnapshot); // Populate final BMC when on last step
                } else {
                    nextBtn.classList.remove('hidden');
                }
                
                if (currentStep === totalSteps) {
                    navButtonsContainer.classList.add('hidden');
                } else {
                    navButtonsContainer.classList.remove('hidden');
                }

                // Scroll to top
                window.scrollTo(0, 0);
            }

            function getStorageKey(groupId = currentGroup) {
                if (!groupId) return null;
                return `${STORAGE_PREFIX}${groupId}`;
            }

            function saveData(options = {}) {
                if (!currentGroup) return {};
                const { skipHistory = false, externalData = null } = options;
                const data = externalData ? { ...externalData } : {};
                if (!externalData) {
                    bmcFields.forEach(field => {
                        const el = document.getElementById(`bmc-${field}`);
                        if (el) {
                            data[field] = el.value;
                        }
                    });
                }

                const dataClone = JSON.parse(JSON.stringify(data));
                const key = getStorageKey();
                const payload = normalizePayload(localStorage.getItem(key), currentGroupName) || { data: {}, history: [] };

                if (!Array.isArray(currentHistory) || !currentHistory.length) {
                    currentHistory = Array.isArray(payload.history) ? payload.history : [];
                    historyIndex = currentHistory.length - 1;
                }

                if (!skipHistory && historyIndex >= 0 && historyIndex < currentHistory.length - 1) {
                    currentHistory = currentHistory.slice(0, historyIndex + 1);
                }

                if (!skipHistory) {
                    const lastEntry = currentHistory[currentHistory.length - 1];
                    const lastSerialized = lastEntry ? JSON.stringify(lastEntry.data) : null;
                    const serialized = JSON.stringify(dataClone);
                    if (serialized !== lastSerialized) {
                        currentHistory = [...currentHistory, { timestamp: Date.now(), data: dataClone }];
                        if (currentHistory.length > HISTORY_LIMIT) {
                            currentHistory = currentHistory.slice(currentHistory.length - HISTORY_LIMIT);
                        }
                        historyIndex = currentHistory.length - 1;
                    }
                }

                if (!skipHistory && !currentHistory.length) {
                    currentHistory = [{ timestamp: Date.now(), data: dataClone }];
                    historyIndex = 0;
                }

                const payloadToSave = {
                    version: STORAGE_VERSION,
                    data: dataClone,
                    history: currentHistory,
                    lastSaved: Date.now(),
                    groupName: currentGroupName
                };
                localStorage.setItem(key, JSON.stringify(payloadToSave));
                latestSnapshot = dataClone;
                updateStickyInfo(dataClone);
                refreshHistoryList();
                refreshGroupList();
                updateVisualization(dataClone);
                return dataClone;
            }
            
            function updateStickyInfo(data) {
                const orElse = '...';
                // VPC Sticky
                document.getElementById('sticky-vpc-pains').textContent = data['vpc-pains'] || orElse;
                document.getElementById('sticky-vpc-gains').textContent = data['vpc-gains'] || orElse;
                document.getElementById('sticky-vpc-relievers').textContent = data['vpc-relievers'] || orElse;
                document.getElementById('sticky-vpc-creators').textContent = data['vpc-creators'] || orElse;
                
                // VP & CS Sticky
                const vpText = data['vp'] || orElse;
                const csText = data['cs'] || orElse;
                document.getElementById('sticky-vp-1').textContent = vpText;
                document.getElementById('sticky-cs-1').textContent = csText;
                document.getElementById('sticky-vp-2').textContent = vpText;
                document.getElementById('sticky-cs-2').textContent = csText;
                document.getElementById('sticky-vp-3').textContent = vpText;
                document.getElementById('sticky-cs-3').textContent = csText;
            }

            function loadData() {
                const key = getStorageKey();
                if (!key) return;
                const payload = normalizePayload(localStorage.getItem(key), currentGroupName);
                
                if (!payload) {
                    document.getElementById('bmc-lab').value = `‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°:\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. \n2. \n3. \n`;
                    document.getElementById('bmc-vpc-products').value = `‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô ...)\n`;
                    latestSnapshot = {};
                    currentHistory = [];
                    historyIndex = -1;
                    updateStickyInfo({});
                    refreshHistoryList();
                    refreshGroupList();
                    refreshAllCharCounters();
                    updateVisualization({});
                    finalBmcFields.forEach(field => renderFinalBlock(field));
                    return;
                }
                
                const data = payload.data || {};
                bmcFields.forEach(field => {
                    const el = document.getElementById(`bmc-${field}`);
                    if (el) {
                        el.value = data[field] || '';
                    }
                });
                latestSnapshot = { ...data };
                currentHistory = Array.isArray(payload.history) ? payload.history : [];
                historyIndex = currentHistory.length - 1;
                updateStickyInfo(data);
                refreshHistoryList();
                refreshGroupList();
                refreshAllCharCounters();
                updateVisualization(data);
            }

            function loadGroupByKey(storageKey) {
                if (!storageKey) return;
                const payload = normalizePayload(localStorage.getItem(storageKey));
                if (!payload) {
                    alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ');
                    return;
                }
                currentGroup = storageKey.replace(STORAGE_PREFIX, '');
                currentGroupName = payload.groupName || currentGroup.replace(/_/g, ' ');
                groupInfo.textContent = currentGroupName;
                groupNameInput.value = currentGroupName;
                printTitle.textContent = `Business Model Canvas: ${currentGroupName}`;
                bmcFields.forEach(field => {
                    const el = document.getElementById(`bmc-${field}`);
                    if (el) {
                        el.value = (payload.data && payload.data[field]) || '';
                    }
                });
                latestSnapshot = { ...(payload.data || {}) };
                currentHistory = Array.isArray(payload.history) ? payload.history : [];
                historyIndex = currentHistory.length - 1;
                updateStickyInfo(latestSnapshot);
                refreshHistoryList();
                refreshGroupList();
                refreshAllCharCounters();
                populateFinalBMC(latestSnapshot);
                updateVisualization(latestSnapshot);
                showSaveIndicator();
            }

            function populateFinalBMC(dataOverride = null) {
                let dataToRender = dataOverride;
                if (!dataToRender) {
                    const payload = normalizePayload(localStorage.getItem(getStorageKey()), currentGroupName);
                    dataToRender = payload ? payload.data : {};
                }
                dataToRender = dataToRender || {};

                finalBmcFields.forEach(field => {
                    renderFinalBlock(field, dataToRender[field] || '');
                });
                updateVisualization(dataToRender);
            }

            function resetData() {
                if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    localStorage.removeItem(getStorageKey());
                    bmcFields.forEach(field => {
                        const el = document.getElementById(`bmc-${field}`);
                        if (el) el.value = '';
                    });
                    // Re-fill Lab/VPC hint
                    document.getElementById('bmc-lab').value = `‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°:\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. \n2. \n3. \n`;
                    document.getElementById('bmc-vpc-products').value = `‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô ...)\n`;
                    latestSnapshot = {};
                    currentHistory = [];
                    historyIndex = -1;
                    updateStickyInfo({});
                    refreshHistoryList();
                    refreshGroupList();
                    refreshAllCharCounters();
                    updateVisualization({});
                    finalBmcFields.forEach(field => renderFinalBlock(field));
                    showStep(1);
                }
            }

            // --- Event Listeners ---

            startBtn.addEventListener('click', initializeWorkshop);
            resetBtn.addEventListener('click', resetData);

            if (aiForm) {
                resetAiOutput();
                renderAiHistory();
                aiForm.addEventListener('submit', handleAiSubmit);
            }
            aiCopyBtn?.addEventListener('click', copyAiOutput);
            aiResetOutputBtn?.addEventListener('click', () => {
                hideAiError();
                resetAiOutput();
            });
            aiClearHistoryBtn?.addEventListener('click', () => {
                if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö Typhoon ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    clearAiHistory();
                }
            });

            // Export/Import/Template event listeners
            document.getElementById('export-data-btn').addEventListener('click', exportData);
            document.getElementById('import-data-btn').addEventListener('change', importData);
            document.getElementById('template-btn').addEventListener('click', () => {
                if (templateModal) {
                    templateModal.classList.remove('hidden');
                }
            });

            if (templateSelectButtons.length) {
                templateSelectButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const templateName = btn.dataset.template;
                        loadTemplate(templateName);
                        templateModal?.classList.add('hidden');
                    });
                });
            }

            closeTemplateModal?.addEventListener('click', () => templateModal?.classList.add('hidden'));
            templateModal?.addEventListener('click', event => {
                if (event.target === templateModal) {
                    templateModal.classList.add('hidden');
                }
            });

            loadGroupBtn?.addEventListener('click', () => {
                if (!groupSwitcher?.value) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î');
                    return;
                }
                loadGroupByKey(groupSwitcher.value);
            });

            compareGroupsBtn?.addEventListener('click', () => {
                populateCompareSelectors();
                compareModal?.classList.remove('hidden');
            });

            closeCompareModal?.addEventListener('click', () => compareModal?.classList.add('hidden'));
            compareModal?.addEventListener('click', event => {
                if (event.target === compareModal) {
                    compareModal.classList.add('hidden');
                }
            });
            runCompareBtn?.addEventListener('click', runComparisonAnalysis);

            undoBtn?.addEventListener('click', undoChange);
            redoBtn?.addEventListener('click', redoChange);
            screenshotBtn?.addEventListener('click', captureScreenshot);
            shareBtn?.addEventListener('click', shareCurrentSnapshot);
            backupAllBtn?.addEventListener('click', backupAllGroups);
            restoreBackupInput?.addEventListener('change', event => {
                const file = event.target.files?.[0];
                if (file) {
                    restoreBackupFromFile(file);
                }
            });
            visualizeBtn?.addEventListener('click', () => updateVisualization(latestSnapshot || {}));

            navTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    showStep(tab.dataset.step);
                });
            });
            
            nextBtn.addEventListener('click', () => {
                if (currentStep < totalSteps) {
                    showStep(currentStep + 1);
                }
            });
            
            backBtn.addEventListener('click', () => {
                if (currentStep > 1) {
                    showStep(currentStep - 1);
                }
            });
            
            exportPdfBtn.addEventListener('click', () => {
                window.print();
            });

            document.addEventListener('keydown', event => {
                if (event.key === 'Escape') {
                    compareModal?.classList.add('hidden');
                    templateModal?.classList.add('hidden');
                }
            });

            // Auto-save on input with debouncing
            function refreshAllCharCounters() {
                document.querySelectorAll('.bmc-textarea, .bmc-textarea-sm').forEach(textarea => {
                    if (typeof textarea._updateCharCounter === 'function') {
                        textarea._updateCharCounter();
                    }
                });
            }

            let saveTimeout;
            document.querySelectorAll('.bmc-textarea, .bmc-textarea-sm').forEach(textarea => {
                const limit = parseInt(textarea.dataset.maxlength || textarea.getAttribute('maxlength') || '500', 10);
                textarea.setAttribute('maxlength', limit);
                textarea.required = true;
                const warningThreshold = Math.floor(limit * 0.9);

                // Add character counter
                const counter = document.createElement('div');
                counter.className = 'char-counter';
                counter.textContent = `0/${limit}`;
                textarea.parentNode.appendChild(counter);

                // Update character counter
                function updateCharCounter() {
                    const length = textarea.value.length;
                    counter.textContent = `${length}/${limit}`;
                    counter.className = 'char-counter';
                    if (length >= limit) {
                        counter.classList.add('danger');
                    } else if (length >= warningThreshold) {
                        counter.classList.add('warning');
                    }
                }
                textarea._updateCharCounter = updateCharCounter;

                textarea.addEventListener('input', () => {
                    if (textarea.value.length > limit) {
                        textarea.value = textarea.value.slice(0, limit);
                    }
                    updateCharCounter();
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(() => {
                        saveData();
                        showSaveIndicator();
                    }, 1000);
                });

                // Initialize counter
                updateCharCounter();
            });

            // Progress bar and dark mode functionality
            function updateProgressBar() {
                if (!progressBarEl || !progressContainer) return;

                const progress = (currentStep / totalSteps) * 100;
                progressBarEl.style.width = `${progress}%`;
                
                // Update progress steps
                progressSteps.forEach((step, index) => {
                    const stepNum = index + 1;
                    step.classList.remove('active', 'completed');
                    
                    if (stepNum === currentStep) {
                        step.classList.add('active');
                    } else if (stepNum < currentStep) {
                        step.classList.add('completed');
                    }
                });
            }

            function showSaveIndicator() {
                const indicator = document.getElementById('save-indicator');
                if (indicator) {
                    indicator.classList.add('show');
                    setTimeout(() => {
                        indicator.classList.remove('show');
                    }, 2000);
                }
            }

            // Dark mode toggle
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            const sunIcon = document.getElementById('sun-icon');
            const moonIcon = document.getElementById('moon-icon');

            function toggleDarkMode() {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                
                if (isDarkMode) {
                    sunIcon.classList.add('hidden');
                    moonIcon.classList.remove('hidden');
                    localStorage.setItem('dark-mode', 'true');
                } else {
                    sunIcon.classList.remove('hidden');
                    moonIcon.classList.add('hidden');
                    localStorage.setItem('dark-mode', 'false');
                }
            }

            // Load dark mode preference
            if (localStorage.getItem('dark-mode') === 'true') {
                document.body.classList.add('dark-mode');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }

            darkModeToggle.addEventListener('click', toggleDarkMode);

            // Enhanced showStep function with progress bar
            const originalShowStep = showStep;
            showStep = function(step) {
                originalShowStep(step);
                updateProgressBar();
                
                // Add fade-in animation to active panel
                const activePanel = document.getElementById(`step-${currentStep}-content`);
                if (activePanel) {
                    activePanel.classList.remove('fade-in');
                    void activePanel.offsetWidth; // Force reflow for animation restart
                    activePanel.classList.add('fade-in');
                }
            };

            // Add tooltips to help icons
            function addTooltips() {
                const helpTexts = {
                    'bmc-lab': '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ñ‡∏∏‡∏ì',
                    'bmc-vp': '‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ - ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á',
                    'bmc-cs': '‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á',
                    'bmc-ch': '‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤',
                    'bmc-cr': '‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤',
                    'bmc-ka': '‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    'bmc-kr': '‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏Å‡∏¥‡∏î',
                    'bmc-kp': '‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
                    'bmc-c': '‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
                    'bmc-r': '‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à'
                };

                Object.keys(helpTexts).forEach(fieldId => {
                    const element = document.getElementById(fieldId);
                    if (element) {
                        const label = element.previousElementSibling;
                        if (label && label.tagName === 'LABEL') {
                            const tooltip = document.createElement('span');
                            tooltip.className = 'tooltip ml-2';
                            tooltip.innerHTML = `
                                <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                </svg>
                                <span class="tooltiptext">${helpTexts[fieldId]}</span>
                            `;
                            label.appendChild(tooltip);
                        }
                    }
                });
            }

            // Add export/import functionality
            function exportData() {
                const data = {};
                bmcFields.forEach(field => {
                    const el = document.getElementById(`bmc-${field}`);
                    if (el) {
                        data[field] = el.value;
                    }
                });

                const payload = normalizePayload(localStorage.getItem(getStorageKey()), currentGroupName);
                const exportObj = {
                    groupName: currentGroupName,
                    timestamp: new Date().toISOString(),
                    version: STORAGE_VERSION,
                    data,
                    history: payload?.history || [],
                    lastSaved: payload?.lastSaved || null
                };
                
                const dataStr = JSON.stringify(exportObj, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `bmc-${currentGroupName}-${new Date().toISOString().split('T')[0]}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            }

            function importData(event) {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = e => {
                    try {
                        const imported = JSON.parse(e.target.result);
                        const payload = imported.data ? imported : { groupName: imported.groupName, data: imported.data || imported };
                        if (!payload.groupName || !payload.data) {
                            throw new Error('invalid');
                        }
                        currentGroupName = payload.groupName;
                        currentGroup = currentGroupName.replace(/[^a-z0-9]/gi, '_');
                        groupInfo.textContent = currentGroupName;
                        groupNameInput.value = currentGroupName;
                        printTitle.textContent = `Business Model Canvas: ${currentGroupName}`;

                        bmcFields.forEach(field => {
                            const el = document.getElementById(`bmc-${field}`);
                            if (el) {
                                el.value = payload.data[field] || '';
                            }
                        });

                        latestSnapshot = { ...(payload.data || {}) };
                        currentHistory = Array.isArray(payload.history) ? payload.history : [];
                        historyIndex = currentHistory.length - 1;
                        saveData({ skipHistory: true, externalData: latestSnapshot });
                        refreshHistoryList();
                        refreshGroupList();
                        refreshAllCharCounters();
                        populateFinalBMC(latestSnapshot);
                        updateVisualization(latestSnapshot);
                        showSaveIndicator();
                        alert('‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!');
                    } catch (error) {
                        alert('‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                    } finally {
                        event.target.value = '';
                    }
                };
                reader.readAsText(file);
            }

            // Add template functionality
            function loadTemplate(templateName) {
                const templates = {
                    'skincare': {
                        'lab': '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£: ‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. ‡∏°‡∏µ‡∏™‡∏≤‡∏£ Triterpenoids ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏°‡∏≤‡∏ô‡πÅ‡∏ú‡∏•\n2. ‡∏™‡∏≤‡∏£ Asiaticoside ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏•‡∏≤‡πÄ‡∏à‡∏ô\n3. ‡∏°‡∏µ‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö\n4. ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏à‡∏≤‡∏Å‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥',
                        'vpc-jobs': '‚Ä¢ ‡∏´‡∏≤‡∏¢‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö\n‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏¢‡∏™‡∏¥‡∏ß‡∏à‡∏≤‡∏á‡∏•‡∏á\n‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢\n‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏±‡∏á‡∏Ñ‡∏°',
                        'vpc-pains': '‚Ä¢ ‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö\n‚Ä¢ ‡∏¢‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á‡∏•‡∏≠‡∏Å\n‚Ä¢ ‡∏£‡∏≠‡∏¢‡∏™‡∏¥‡∏ß‡∏´‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô\n‚Ä¢ ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏¢‡∏≤\n‚Ä¢ ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤',
                        'vpc-gains': '‚Ä¢ ‡∏´‡∏≤‡∏¢‡πÑ‡∏ß‡πÜ ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ô\n‚Ä¢ ‡∏ú‡∏¥‡∏ß‡πÑ‡∏°‡πà‡πÅ‡∏´‡πâ‡∏á‡πÑ‡∏°‡πà‡∏•‡∏≠‡∏Å\n‚Ä¢ ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢\n‚Ä¢ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤\n‚Ä¢ ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏à‡∏≤‡∏Å‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)\n‚Ä¢ ‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö',
                        'vp': '‡πÄ‡∏à‡∏•‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÉ‡∏ô 6 ‡∏ä‡∏°. ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏î‡∏£‡∏≠‡∏¢‡∏î‡∏≥ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á‡∏•‡∏≠‡∏Å',
                        'cs': '‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô-‡∏ß‡∏±‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (15-35 ‡∏õ‡∏µ) ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏¥‡∏ß‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö ‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≠‡∏¢‡πÅ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏á‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û',
                        'ch': 'Online (Shopee, TikTok Shop, Lazada, Brand Website), Offline (‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤, Watsons, Eveandboy, ‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏ã‡∏∑‡πâ‡∏≠)',
                        'cr': '‡∏™‡∏£‡πâ‡∏≤‡∏á Community ‡∏Ñ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ß ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÇ‡∏î‡∏¢‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ú‡πà‡∏≤‡∏ô TikTok ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∞‡∏™‡∏°‡πÅ‡∏ï‡πâ‡∏° ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß',
                        'ka': 'R&D (‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏£) ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î Digital (‡∏¢‡∏¥‡∏á Ads, Live) ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (QC) ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤',
                        'kr': '‡∏™‡∏π‡∏ï‡∏£‡∏ï‡∏≥‡∏£‡∏±‡∏ö (IP) ‡∏ó‡∏µ‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢/‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£ Brand ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô ‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‡∏≠‡∏¢. ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢',
                        'kp': '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏¥‡∏ï (OEM) ‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î Influencers (KOLs) ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏à‡∏±‡∏¢)',
                        'c': '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï (‡πÅ‡∏õ‡∏£‡∏ú‡∏±‡∏ô) ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (Fixed + Ads) ‡∏Ñ‡πà‡∏≤ R&D ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á Influencer ‡∏Ñ‡πà‡∏≤ GP ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢',
                        'r': '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏à‡∏•‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏¥‡∏ß (B2C/D2C) ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏≤ (B2B) ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ã‡∏£‡∏±‡πà‡∏°)'
                    },
                    'sleep': {
                        'lab': '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£: ‡∏î‡∏≠‡∏Å‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå + ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô + ‡∏á‡∏≤‡∏î‡∏≥\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. Apigenin ‡πÉ‡∏ô‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢\n2. L-theanine ‡πÉ‡∏ô‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î\n3. ‡∏á‡∏≤‡∏î‡∏≥‡∏°‡∏µ‡πÅ‡∏Ñ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡∏Å‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏™‡∏π‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö\n4. ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å',
                        'vpc-jobs': '‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏•‡∏∂‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å\n‚Ä¢ ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏î‡∏∂‡∏Å\n‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ï‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà',
                        'vpc-pains': '‚Ä¢ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î\n‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á‡∏¢‡∏≤‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö\n‚Ä¢ ‡∏ï‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß/‡∏°‡∏∂‡∏ô‡∏á‡∏á\n‚Ä¢ ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î',
                        'vpc-gains': '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 20 ‡∏ô‡∏≤‡∏ó‡∏µ\n‚Ä¢ ‡∏ï‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏∂‡∏ô\n‚Ä¢ ‡∏°‡∏µ‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏î‡∏µ\n‚Ä¢ ‡∏°‡∏µ‡πÇ‡∏Ñ‡πâ‡∏ä‡∏Ñ‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥',
                        'vpc-products': '‡∏ä‡∏∏‡∏î‡∏ä‡∏≤ Sleep Well + ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô + Podcast ‡∏ä‡∏ß‡∏ô‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢',
                        'vpc-relievers': '‚Ä¢ ‡∏Å‡∏£‡∏î‡∏≠‡∏∞‡∏°‡∏¥‡πÇ‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î Cortisol\n‚Ä¢ ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏´‡∏≠‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏á‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó\n‚Ä¢ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≤‡πÄ‡∏ü‡∏≠‡∏µ‡∏ô',
                        'vpc-creators': '‚Ä¢ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° 21 ‡∏ß‡∏±‡∏ô+‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏¥‡∏ö‡∏ä‡∏≤\n‚Ä¢ Sleep coach ‡∏ú‡πà‡∏≤‡∏ô LINE OA\n‚Ä¢ Playlist ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô',
                        'vp': 'Sleep Well Blend ‚Äì ‡∏ä‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£‡∏£‡∏° 3 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏´‡∏•‡∏±‡∏ö‡∏•‡∏∂‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 21 ‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á‡∏¢‡∏≤',
                        'cs': '‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®‡∏≠‡∏≤‡∏¢‡∏∏ 25-45 ‡∏õ‡∏µ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏á‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥',
                        'ch': '‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (Subscription), ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏≤‡πÄ‡∏ü‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö',
                        'cr': 'Community ‚ÄúSleep Club‚Äù ‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö, Live Q&A ‡∏Å‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô',
                        'ka': '‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏™‡∏π‡∏ï‡∏£‡∏ä‡∏≤, ‡∏ú‡∏•‡∏¥‡∏ï‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå, ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á Subscription ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
                        'kr': '‡∏™‡∏π‡∏ï‡∏£‡∏ä‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞, Sleep coach, ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤',
                        'kp': '‡πÇ‡∏£‡∏á‡∏Ñ‡∏±‡πà‡∏ß‡∏ä‡∏≤‡∏≠‡∏≠‡∏£‡πå‡πÅ‡∏Å‡∏ô‡∏¥‡∏Å, ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô, Influencer ‡∏î‡πâ‡∏≤‡∏ô Wellness, ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô',
                        'c': '‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå, ‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå, ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å, ‡∏ó‡∏µ‡∏° Sleep Coach, ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•',
                        'r': '‡∏Ñ‡πà‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°, Workshop ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô'
                    },
                    'energy': {
                        'lab': '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£: ‡πÇ‡∏™‡∏°‡πÑ‡∏ó‡∏¢ + ‡∏Å‡∏£‡∏∞‡∏ä‡∏≤‡∏¢‡∏î‡∏≥ + ‡∏Ç‡∏¥‡∏á‡πÅ‡∏Å‡πà\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. ‡πÇ‡∏™‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏≤‡∏ò‡∏¥\n2. ‡∏Å‡∏£‡∏∞‡∏ä‡∏≤‡∏¢‡∏î‡∏≥‡∏°‡∏µ‡∏ü‡∏•‡∏≤‡πÇ‡∏ß‡∏ô‡∏≠‡∏¢‡∏î‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î\n3. ‡∏Ç‡∏¥‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏°‡∏ï‡∏≤‡∏ö‡∏≠‡∏•‡∏¥‡∏ã‡∏∂‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î',
                        'vpc-jobs': '‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°/‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢\n‚Ä¢ ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏∑‡πà‡∏°‡∏Å‡∏≤‡πÅ‡∏ü‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏Å‡πâ‡∏ß\n‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏°‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô',
                        'vpc-pains': '‚Ä¢ ‡∏Å‡∏≤‡πÅ‡∏ü‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô/‡∏Å‡∏£‡∏∞‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏ß‡∏≤‡∏¢\n‚Ä¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ä‡∏π‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\n‚Ä¢ ‡∏û‡∏Å‡∏û‡∏≤‡∏•‡∏≥‡∏ö‡∏≤‡∏Å',
                        'vpc-gains': '‚Ä¢ ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏≤‡∏ô 4-6 ‡∏ä‡∏°.\n‚Ä¢ ‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏™‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥\n‚Ä¢ ‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô sugar-free\n‚Ä¢ ‡∏û‡∏Å‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤',
                        'vpc-products': 'Energy Shot 60 ml + ‡∏™‡∏π‡∏ï‡∏£‡∏ú‡∏á‡∏ä‡∏á + ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£',
                        'vpc-relievers': '‚Ä¢ ‡∏™‡∏π‡∏ï‡∏£ low sugar, ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≤‡πÄ‡∏ü‡∏≠‡∏µ‡∏ô‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå\n‚Ä¢ ‡πÄ‡∏ï‡∏¥‡∏°‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡πÇ‡∏ó‡∏£‡πÑ‡∏•‡∏ï‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤',
                        'vpc-creators': '‚Ä¢ Dashboard ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô\n‚Ä¢ ‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô/‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á',
                        'vp': '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ Energy Shot 2 ‡∏ä‡∏±‡πâ‡∏ô (‡πÇ‡∏™‡∏°+‡∏Å‡∏£‡∏∞‡∏ä‡∏≤‡∏¢‡∏î‡∏≥) ‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
                        'cs': '‡∏ô‡∏±‡∏Å‡∏Å‡∏µ‡∏¨‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏•‡πà‡∏ô, ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏¢‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ó‡∏µ‡∏ü, ‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ò‡∏¥',
                        'ch': '‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤, ‡∏ü‡∏¥‡∏ï‡πÄ‡∏ô‡∏™, ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏µ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏¥‡∏£‡πå‡∏ã, ‡∏ï‡∏π‡πâ Vending ‡πÉ‡∏ô Co-working space',
                        'cr': '‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∞‡∏™‡∏°‡∏û‡∏•‡∏±‡∏á (Gamification), ‡πÇ‡∏Ñ‡πâ‡∏ä‡∏ü‡∏¥‡∏ï‡πÄ‡∏ô‡∏™‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ, ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏î‡∏•‡∏≠‡∏á 7 ‡∏ß‡∏±‡∏ô',
                        'ka': '‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏π‡∏ï‡∏£, ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û, ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á, ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏Å‡∏µ‡∏¨‡∏≤',
                        'kr': '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏Å‡∏±‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô, ‡∏ó‡∏µ‡∏°‡πÇ‡∏Ñ‡πâ‡∏ä, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ, ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏™‡∏π‡∏ï‡∏£',
                        'kp': '‡∏™‡∏°‡∏≤‡∏Ñ‡∏°‡∏Å‡∏µ‡∏¨‡∏≤, ‡∏£‡πâ‡∏≤‡∏ô‡∏ü‡∏¥‡∏ï‡πÄ‡∏ô‡∏™, ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå, Influencer ‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
                        'c': '‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á, ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏, ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏¥‡∏ô‡∏ü‡∏•‡∏π‡πÄ‡∏≠‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå, ‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå Cold-chain',
                        'r': '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Ç‡∏ß‡∏î, ‡πÅ‡∏û‡πá‡∏Å Subscription, B2B ‡πÉ‡∏´‡πâ‡∏ü‡∏¥‡∏ï‡πÄ‡∏ô‡∏™/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó, ‡∏™‡∏õ‡∏≠‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏Å‡∏µ‡∏¨‡∏≤'
                    },
                    'immune': {
                        'lab': '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£: ‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£ + ‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß + ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á‡∏î‡∏≠‡∏Å‡∏•‡∏≥‡πÑ‡∏¢\n\n‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:\n1. Andrographolide ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô\n2. ‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö‡∏°‡∏µ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ã‡∏µ‡∏™‡∏π‡∏á‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏≠‡∏¥‡∏™‡∏£‡∏∞\n3. ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á‡∏°‡∏µ‡∏™‡∏≤‡∏£‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û‡∏ï‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥',
                        'vpc-jobs': '‚Ä¢ ‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏õ‡πà‡∏ß‡∏¢‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏§‡∏î‡∏π\n‚Ä¢ ‡∏°‡∏≠‡∏á‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
                        'vpc-pains': '‚Ä¢ ‡πÄ‡∏î‡πá‡∏Å‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏Å\n‚Ä¢ ‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏ä‡∏ô‡∏¥‡∏î‡∏°‡∏µ‡∏£‡∏™‡∏Ç‡∏°\n‚Ä¢ ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢',
                        'vpc-gains': '‚Ä¢ ‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡∏Å‡∏•‡∏°‡∏Å‡∏•‡πà‡∏≠‡∏° ‡πÄ‡∏î‡πá‡∏Å‡∏î‡∏∑‡πà‡∏°‡πÑ‡∏î‡πâ\n‚Ä¢ ‡∏°‡∏µ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á ‡∏≠‡∏¢. ‡πÅ‡∏•‡∏∞ HACCP\n‚Ä¢ ‡∏°‡∏µ‡∏™‡∏π‡∏ï‡∏£‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏¢‡πá‡∏ô',
                        'vpc-products': 'Immune Booster Tea Bag + ‡∏ã‡∏≠‡∏™‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡∏ú‡∏™‡∏°‡∏ô‡πâ‡∏≥‡πÇ‡∏ã‡∏î‡∏≤ + ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ 5 ‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥',
                        'vpc-relievers': '‚Ä¢ ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏™‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á‡∏•‡∏≥‡πÑ‡∏¢\n‚Ä¢ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏ß',
                        'vpc-creators': '‚Ä¢ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß\n‚Ä¢ ‡∏Ñ‡∏•‡∏≤‡∏™‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏±‡∏ö‡πÄ‡∏†‡∏™‡∏±‡∏ä',
                        'vp': 'Immune Booster Tea ‚Äì ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÑ‡∏ó‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏™ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏î‡πá‡∏Å‡∏î‡∏∑‡πà‡∏°‡πÑ‡∏î‡πâ ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ö‡πâ‡∏≤‡∏ô',
                        'cs': '‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏°‡πà‡∏ß‡∏±‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô, ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
                        'ch': '‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏¢‡∏≤, Modern Trade, ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô, ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå',
                        'cr': 'LINE OA ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏π‡∏ï‡∏£‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå, ‡∏Ñ‡∏•‡∏≤‡∏™ Live ‡∏Å‡∏±‡∏ö‡πÄ‡∏†‡∏™‡∏±‡∏ä, ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß',
                        'ka': '‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö, ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß, ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å',
                        'kr': '‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß, ‡∏ó‡∏µ‡∏° R&D, ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô, ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô',
                        'kp': '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå, ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡∏≤‡∏Å, ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢',
                        'c': '‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•, ‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°, ‡∏Ñ‡πà‡∏≤ QC, ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß',
                        'r': '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ä‡∏≤‡∏ã‡∏≠‡∏á, ‡∏ã‡∏≠‡∏™‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô, ‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•, ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå'
                    }
                };

                if (templates[templateName]) {
                    const template = templates[templateName];
                    bmcFields.forEach(field => {
                        const el = document.getElementById(`bmc-${field}`);
                        if (el && template[field]) {
                            el.value = template[field];
                        }
                    });
                    refreshAllCharCounters();
                    saveData();
                    showSaveIndicator();
                    populateFinalBMC(template);
                    updateVisualization(template);
                }
            }

            // Initialize enhancements
            refreshGroupList();
            refreshHistoryList();
            finalBmcFields.forEach(field => renderFinalBlock(field));
            setTimeout(() => {
                addTooltips();
                updateProgressBar();
            }, 100);

        });
    </script>
</body>
</html>
